From 6d43dc0f0d3c17161d2e154b883cd13102a5af98 Mon Sep 17 00:00:00 2001
From: Dave Airlie <airlied@redhat.com>
Date: Sat, 19 May 2012 16:33:21 +0100
Subject: [PATCH 2/5] drm/cirrus/ast/mgag200: fix build without
 CONFIG_VGA_CONSOLE

Reported-by: Randy Dunlap
Signed-off-by: Dave Airlie <airlied@redhat.com>
Signed-off-by: Stefan Lippers-Hollmann <s.l-h@gmx.de>
---
 drivers/gpu/drm/cirrus/cirrus_drv.c   |    2 +
 1 file changed,2 insertions(+)

--- a/drivers/gpu/drm/cirrus/cirrus_drv.c
+++ b/drivers/gpu/drm/cirrus/cirrus_drv.c
@@ -84,8 +84,10 @@ static struct pci_driver cirrus_pci_driv
 
 static int __init cirrus_init(void)
 {
+#ifdef CONFIG_VGA_CONSOLE
 	if (vgacon_text_force() && cirrus_modeset == -1)
 		return -EINVAL;
+#endif
 
 	if (cirrus_modeset == 0)
 		return -EINVAL;
