From 6f92ec2dd988d9d40fd8f9745380aa0198769104 Mon Sep 17 00:00:00 2001
From: Stefan Lippers-Hollmann <s.l-h@gmx.de>
Date: Mon, 5 Sep 2011 13:32:07 +0200
Subject: [PATCH 7/7] Revert "rt2x00: fix crash in rt2800usb_get_txwi"

This reverts commit 759210127789fb4691db6d78693f28027b2cbb22.
---
 drivers/net/wireless/rt2x00/rt2800lib.c |    7 ++++---
 1 files changed, 4 insertions(+), 3 deletions(-)

--- a/drivers/net/wireless/rt2x00/rt2800lib.c
+++ b/drivers/net/wireless/rt2x00/rt2800lib.c
@@ -754,11 +754,12 @@ void rt2800_txdone(struct rt2x00_dev *rt
 			entry = rt2x00queue_get_entry(queue, Q_INDEX_DONE);
 			if (rt2800_txdone_entry_check(entry, reg))
 				break;
-			entry = NULL;
 		}
 
-		if (entry)
-			rt2800_txdone_entry(entry, reg);
+		if (!entry || rt2x00queue_empty(queue))
+			break;
+
+		rt2800_txdone_entry(entry, reg);
 	}
 }
 EXPORT_SYMBOL_GPL(rt2800_txdone);
