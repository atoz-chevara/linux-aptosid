From 6c26f17440a384120c5b0436f6b6aeda3ee18c1d Mon Sep 17 00:00:00 2001
From: Larry Finger <Larry.Finger@lwfinger.net>
Date: Sun, 28 Apr 2013 16:22:22 -0500
Subject: [PATCH 082/210] Convert typedef _list

Signed-off-by: Larry Finger <Larry.Finger@lwfinger.net>
---
 core/rtw_ap.c           | 23 ++++++++++-------------
 core/rtw_debug.c        |  2 +-
 core/rtw_ioctl_set.c    |  2 +-
 core/rtw_mlme.c         | 16 +++++++---------
 core/rtw_mlme_ext.c     |  6 +++---
 core/rtw_p2p.c          |  6 +++---
 core/rtw_recv.c         | 18 ++++++++----------
 core/rtw_sta_mgt.c      | 26 ++++++++------------------
 core/rtw_xmit.c         | 18 +++++++++---------
 hal/rtl8192d_dm.c       |  2 +-
 hal/rtl8192du_xmit.c    |  4 ++--
 include/ieee80211.h     |  2 +-
 include/osdep_service.h | 19 +++++++++----------
 include/rtw_cmd.h       |  4 ++--
 include/rtw_io.h        |  8 ++++----
 include/rtw_mlme.h      |  2 +-
 include/rtw_mp.h        |  2 +-
 include/rtw_recv.h      | 12 ++++--------
 include/rtw_xmit.h      | 10 +++++-----
 include/sta_info.h      | 21 ++++++++-------------
 include/wlan_bssdef.h   |  2 +-
 os_dep/ioctl_linux.c    | 35 ++++++++++++++++-------------------
 os_dep/osdep_service.c  | 10 +++++-----
 os_dep/xmit_linux.c     |  2 +-
 24 files changed, 111 insertions(+), 141 deletions(-)

--- a/drivers/staging/rtl8192du/core/rtw_ap.c
+++ b/drivers/staging/rtl8192du/core/rtw_ap.c
@@ -349,7 +349,7 @@ u8 chk_sta_is_alive(struct sta_info *pst
 
 void	expire_timeout_chk(_adapter *padapter)
 {
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	u8 updated;
 	struct sta_info *psta=NULL;
 	struct sta_priv *pstapriv = &padapter->stapriv;
@@ -369,16 +369,13 @@ void	expire_timeout_chk(_adapter *padapt
 			, FUNC_NDEV_ARG(padapter->pnetdev), pstapriv->auth_list_cnt);
 	}
 	#endif
-	while ((rtw_end_of_queue_search(phead, plist)) == false)
-	{
+	while ((rtw_end_of_queue_search(phead, plist)) == false) {
 		psta = LIST_CONTAINOR(plist, struct sta_info, auth_list);
 		plist = get_next(plist);
 
-		if(psta->expire_to>0)
-		{
+		if (psta->expire_to > 0) {
 			psta->expire_to--;
-			if (psta->expire_to == 0)
-			{
+			if (psta->expire_to == 0) {
 				rtw_list_delete(&psta->auth_list);
 				pstapriv->auth_list_cnt--;
 
@@ -1747,7 +1744,7 @@ void rtw_set_macaddr_acl(_adapter *padap
 
 int rtw_acl_add_sta(_adapter *padapter, u8 *addr)
 {
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	u8 added = false;
 	int i, ret=0;
 	struct rtw_wlan_acl_node *paclnode;
@@ -1820,7 +1817,7 @@ int rtw_acl_add_sta(_adapter *padapter,
 
 int rtw_acl_remove_sta(_adapter *padapter, u8 *addr)
 {
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	int i, ret=0;
 	struct rtw_wlan_acl_node *paclnode;
 	struct sta_priv *pstapriv = &padapter->stapriv;
@@ -2192,7 +2189,7 @@ void associated_clients_update(_adapter
 	//update associcated stations cap.
 	if(updated == true)
 	{
-		_list	*phead, *plist;
+		struct list_head *phead, *plist;
 		struct sta_info *psta=NULL;
 		struct sta_priv *pstapriv = &padapter->stapriv;
 
@@ -2558,7 +2555,7 @@ u8 ap_free_sta(_adapter *padapter, struc
 
 int rtw_ap_inform_ch_switch(_adapter *padapter, u8 new_ch, u8 ch_offset)
 {
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	int ret=0;
 	struct sta_info *psta = NULL;
 	struct sta_priv *pstapriv = &padapter->stapriv;
@@ -2594,7 +2591,7 @@ int rtw_ap_inform_ch_switch(_adapter *pa
 
 int rtw_sta_flush(_adapter *padapter)
 {
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	int ret=0;
 	struct sta_info *psta = NULL;
 	struct sta_priv *pstapriv = &padapter->stapriv;
@@ -2740,7 +2737,7 @@ void start_ap_mode(_adapter *padapter)
 
 void stop_ap_mode(_adapter *padapter)
 {
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	struct rtw_wlan_acl_node *paclnode;
 	struct sta_info *psta=NULL;
 	struct sta_priv *pstapriv = &padapter->stapriv;
--- a/drivers/staging/rtl8192du/core/rtw_debug.c
+++ b/drivers/staging/rtl8192du/core/rtw_debug.c
@@ -1046,7 +1046,7 @@ int proc_get_all_sta_info(char *page, ch
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
 	struct sta_priv *pstapriv = &padapter->stapriv;
 	int i, j;
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	struct recv_reorder_ctrl *preorder_ctrl;
 	int len = 0;
 
--- a/drivers/staging/rtl8192du/core/rtw_ioctl_set.c
+++ b/drivers/staging/rtl8192du/core/rtw_ioctl_set.c
@@ -70,7 +70,7 @@ _func_exit_;
 u8 rtw_do_join(_adapter * padapter);
 u8 rtw_do_join(_adapter * padapter)
 {
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	u8* pibss = NULL;
 	struct	mlme_priv	*pmlmepriv = &(padapter->mlmepriv);
 	_queue	*queue	= &(pmlmepriv->scanned_queue);
--- a/drivers/staging/rtl8192du/core/rtw_mlme.c
+++ b/drivers/staging/rtl8192du/core/rtw_mlme.c
@@ -216,7 +216,7 @@ struct	wlan_network *_rtw_alloc_network(
 {
 	struct	wlan_network	*pnetwork;
 	_queue *free_queue = &pmlmepriv->free_bss_pool;
-	_list* plist = NULL;
+	struct list_head *plist = NULL;
 
 _func_enter_;
 
@@ -329,7 +329,7 @@ _func_exit_;
 struct wlan_network *_rtw_find_network(_queue *scanned_queue, u8 *addr)
 {
 
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	struct	wlan_network *pnetwork = NULL;
 	u8 zero_addr[ETH_ALEN] = {0,0,0,0,0,0};
 
@@ -371,7 +371,7 @@ _func_exit_;
 
 void _rtw_free_network_queue(_adapter *padapter, u8 isfreeall)
 {
-	_list *phead, *plist;
+	struct list_head *phead, *plist;
 	struct wlan_network *pnetwork;
 	struct mlme_priv* pmlmepriv = &padapter->mlmepriv;
 	_queue *scanned_queue = &pmlmepriv->scanned_queue;
@@ -610,9 +610,7 @@ _func_exit_;
 
 struct	wlan_network	* rtw_get_oldest_wlan_network(_queue *scanned_queue)
 {
-	_list	*plist, *phead;
-
-
+	struct list_head *plist, *phead;
 	struct	wlan_network	*pwlan = NULL;
 	struct	wlan_network	*oldest = NULL;
 _func_enter_;
@@ -746,7 +744,7 @@ Caller must hold pmlmepriv->lock first.
 */
 void rtw_update_scanned_network(_adapter *adapter, WLAN_BSSID_EX *target)
 {
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	u32	bssid_ex_sz;
 	struct mlme_priv	*pmlmepriv = &(adapter->mlmepriv);
 	_queue	*queue	= &(pmlmepriv->scanned_queue);
@@ -1187,7 +1185,7 @@ static void free_scanqueue(struct	mlme_p
 {
 	_queue *free_queue = &pmlmepriv->free_bss_pool;
 	_queue *scan_queue = &pmlmepriv->scanned_queue;
-	_list	*plist, *phead, *ptemp;
+	struct list_head *plist, *phead, *ptemp;
 
 _func_enter_;
 
@@ -2441,7 +2439,7 @@ pmlmepriv->lock
 int rtw_select_and_join_from_scanned_queue(struct mlme_priv *pmlmepriv )
 {
 	int ret;
-	_list	*phead;
+	struct list_head *phead;
 	_adapter *adapter;
 	_queue	*queue	= &(pmlmepriv->scanned_queue);
 	struct	wlan_network	*pnetwork = NULL;
--- a/drivers/staging/rtl8192du/core/rtw_mlme_ext.c
+++ b/drivers/staging/rtl8192du/core/rtw_mlme_ext.c
@@ -7933,7 +7933,7 @@ exit:
 
 void issue_action_spct_ch_switch(_adapter *padapter, u8 *ra, u8 new_ch, u8 ch_offset)
 {
-	_list		*plist, *phead;
+	struct list_head *plist, *phead;
 	struct xmit_frame			*pmgntframe;
 	struct pkt_attrib			*pattrib;
 	unsigned char				*pframe;
@@ -8126,7 +8126,7 @@ void issue_action_BA(_adapter *padapter,
 
 static void issue_action_BSSCoexistPacket(_adapter *padapter)
 {
-	_list		*plist, *phead;
+	struct list_head *plist, *phead;
 	unsigned char category, action;
 	struct xmit_frame			*pmgntframe;
 	struct pkt_attrib			*pattrib;
@@ -11198,7 +11198,7 @@ u8 tx_beacon_hdl(_adapter *padapter, uns
 	else //tx bc/mc frames after update TIM
 	{
 		struct sta_info *psta_bmc;
-		_list	*xmitframe_plist, *xmitframe_phead;
+		struct list_head *xmitframe_plist, *xmitframe_phead;
 		struct xmit_frame *pxmitframe=NULL;
 		struct sta_priv  *pstapriv = &padapter->stapriv;
 
--- a/drivers/staging/rtl8192du/core/rtw_p2p.c
+++ b/drivers/staging/rtl8192du/core/rtw_p2p.c
@@ -42,7 +42,7 @@ int rtw_p2p_is_channel_list_ok( u8 desir
 
 int	is_any_client_associated( _adapter *padapter )
 {
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	int	intFound = false;
 
 	struct sta_priv *pstapriv = &padapter->stapriv;
@@ -74,7 +74,7 @@ int	is_any_client_associated( _adapter *
 
 static u32 go_add_group_info_attr(struct wifidirect_info *pwdinfo, u8 *pbuf)
 {
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	u32 len=0;
 	u16 attr_len = 0;
 	u8 tmplen, *pdata_attr, *pstart, *pcur;
@@ -2486,7 +2486,7 @@ u32 process_p2p_devdisc_req(struct wifid
 				attr_contentlen=0;
 				if(rtw_get_p2p_attr_content(p2p_ie, p2p_ielen, P2P_ATTR_DEVICE_ID, dev_addr, &attr_contentlen))
 				{
-					_list	*phead, *plist;
+					struct list_head *phead, *plist;
 
 					spin_lock_bh(&pstapriv->asoc_list_lock);
 					phead = &pstapriv->asoc_list;
--- a/drivers/staging/rtl8192du/core/rtw_recv.c
+++ b/drivers/staging/rtl8192du/core/rtw_recv.c
@@ -177,7 +177,7 @@ union recv_frame *_rtw_alloc_recvframe (
 {
 
 	union recv_frame  *precvframe;
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	_adapter *padapter;
 	struct recv_priv *precvpriv;
 _func_enter_;
@@ -323,7 +323,7 @@ using spinlock to protect
 void rtw_free_recvframe_queue(_queue *pframequeue,  _queue *pfree_recv_queue)
 {
 	union	recv_frame	*precvframe;
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 
 _func_enter_;
 	_rtw_spinlock(&pframequeue->lock);
@@ -337,8 +337,6 @@ _func_enter_;
 
 		plist = get_next(plist);
 
-		//rtw_list_delete(&precvframe->u.hdr.list); // will do this in rtw_free_recvframe()
-
 		rtw_free_recvframe(precvframe, pfree_recv_queue);
 	}
 
@@ -397,7 +395,7 @@ struct recv_buf *rtw_dequeue_recvbuf (_q
 {
 	long unsigned int irqL;
 	struct recv_buf *precvbuf;
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 
 	spin_lock_irqsave(&queue->lock, irqL);
 
@@ -1543,7 +1541,7 @@ int validate_recv_ctrl_frame(_adapter *p
 
 		if((psta->state&WIFI_SLEEP_STATE) && (pstapriv->sta_dz_bitmap&BIT(psta->aid)))
 		{
-			_list	*xmitframe_plist, *xmitframe_phead;
+			struct list_head *xmitframe_plist, *xmitframe_phead;
 			struct xmit_frame *pxmitframe=NULL;
 
 			spin_lock_bh(&psta->sleep_q.lock);
@@ -2000,7 +1998,7 @@ _func_exit_;
 union recv_frame * recvframe_defrag(_adapter *adapter,_queue *defrag_q);
 union recv_frame * recvframe_defrag(_adapter *adapter,_queue *defrag_q)
 {
-	_list	 *plist, *phead;
+	struct list_head *plist, *phead;
 	u8	*data,wlanhdr_offset;
 	u8	curfragnum;
 	struct recv_frame_hdr *pfhdr,*pnfhdr;
@@ -2094,7 +2092,7 @@ union recv_frame* recvframe_chk_defrag(P
 	struct recv_frame_hdr *pfhdr;
 	struct sta_info *psta;
 	struct sta_priv *pstapriv;
-	_list *phead;
+	struct list_head *phead;
 	union recv_frame *prtnframe = NULL;
 	_queue *pfree_recv_queue, *pdefrag_q;
 
@@ -2473,7 +2471,7 @@ int enqueue_reorder_recvframe(struct rec
 {
 	struct rx_pkt_attrib *pattrib = &prframe->u.hdr.attrib;
 	_queue *ppending_recvframe_queue = &preorder_ctrl->pending_recvframe_queue;
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	union recv_frame *pnextrframe;
 	struct rx_pkt_attrib *pnextattrib;
 
@@ -2533,7 +2531,7 @@ int enqueue_reorder_recvframe(struct rec
 int recv_indicatepkts_in_order(_adapter *padapter, struct recv_reorder_ctrl *preorder_ctrl, int bforced);
 int recv_indicatepkts_in_order(_adapter *padapter, struct recv_reorder_ctrl *preorder_ctrl, int bforced)
 {
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	union recv_frame *prframe;
 	struct rx_pkt_attrib *pattrib;
 	int bPktInBuf = false;
--- a/drivers/staging/rtl8192du/core/rtw_sta_mgt.c
+++ b/drivers/staging/rtl8192du/core/rtw_sta_mgt.c
@@ -27,7 +27,6 @@
 #include <mlme_osdep.h>
 #include <sta_info.h>
 
-void _rtw_init_stainfo(struct sta_info *psta);
 void _rtw_init_stainfo(struct sta_info *psta)
 {
 
@@ -38,9 +37,6 @@ _func_enter_;
 	 _rtw_spinlock_init(&psta->lock);
 	_rtw_init_listhead(&psta->list);
 	_rtw_init_listhead(&psta->hash_list);
-	//_rtw_init_listhead(&psta->asoc_list);
-	//_rtw_init_listhead(&psta->sleep_list);
-	//_rtw_init_listhead(&psta->wakeup_list);
 
 	_rtw_init_queue(&psta->sleep_q);
 	psta->sleepq_len = 0;
@@ -99,7 +95,6 @@ _func_enter_;
 
 	_rtw_spinlock_init(&pstapriv->sta_hash_lock);
 
-	//_rtw_init_queue(&pstapriv->asoc_q);
 	pstapriv->asoc_sta_count = 0;
 	_rtw_init_queue(&pstapriv->sleep_q);
 	_rtw_init_queue(&pstapriv->wakeup_q);
@@ -107,8 +102,7 @@ _func_enter_;
 	psta = (struct sta_info *)(pstapriv->pstainfo_buf);
 
 
-	for(i = 0; i < NUM_STA; i++)
-	{
+	for(i = 0; i < NUM_STA; i++) {
 		_rtw_init_stainfo(psta);
 
 		_rtw_init_listhead(&(pstapriv->sta_hash[i]));
@@ -214,7 +208,7 @@ _func_exit_;
 void rtw_mfree_all_stainfo(struct sta_priv *pstapriv );
 void rtw_mfree_all_stainfo(struct sta_priv *pstapriv )
 {
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	struct sta_info *psta = NULL;
 
 _func_enter_;
@@ -263,7 +257,7 @@ void rtw_mfree_sta_priv_lock(struct	sta_
 
 u32	_rtw_free_sta_priv(struct	sta_priv *pstapriv)
 {
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	struct sta_info *psta = NULL;
 	struct recv_reorder_ctrl *preorder_ctrl;
 	int	index;
@@ -311,7 +305,7 @@ struct	sta_info *rtw_alloc_stainfo(struc
 {
 	uint tmp_aid;
 	s32	index;
-	_list	*phash_list;
+	struct list_head *phash_list;
 	struct sta_info	*psta;
 	_queue *pfree_sta_queue;
 	struct recv_reorder_ctrl *preorder_ctrl;
@@ -496,7 +490,7 @@ _func_enter_;
 	//for A-MPDU Rx reordering buffer control, cancel reordering_ctrl_timer
 	for(i=0; i < 16 ; i++)
 	{
-		_list	*phead, *plist;
+		struct list_head *phead, *plist;
 		union recv_frame *prframe;
 		_queue *ppending_recvframe_queue;
 		_queue *pfree_recv_queue = &padapter->recvpriv.free_recv_queue;
@@ -585,7 +579,7 @@ _func_exit_;
 // free all stainfo which in sta_hash[all]
 void rtw_free_all_stainfo(_adapter *padapter)
 {
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	s32	index;
 	struct sta_info *psta = NULL;
 	struct	sta_priv *pstapriv = &padapter->stapriv;
@@ -627,14 +621,10 @@ _func_exit_;
 struct sta_info *rtw_get_stainfo(struct sta_priv *pstapriv, u8 *hwaddr)
 {
 
-	_list	*plist, *phead;
-
+	struct list_head *plist, *phead;
 	struct sta_info *psta = NULL;
-
 	u32	index;
-
 	u8 *addr;
-
 	u8 bc_addr[ETH_ALEN] = {0xff,0xff,0xff,0xff,0xff,0xff};
 
 _func_enter_;
@@ -723,7 +713,7 @@ u8 rtw_access_ctrl(_adapter *padapter, u
 {
 	u8 res = true;
 #ifdef  CONFIG_AP_MODE
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	struct rtw_wlan_acl_node *paclnode;
 	u8 match = false;
 	struct sta_priv *pstapriv = &padapter->stapriv;
--- a/drivers/staging/rtl8192du/core/rtw_xmit.c
+++ b/drivers/staging/rtl8192du/core/rtw_xmit.c
@@ -1848,7 +1848,7 @@ struct xmit_buf *rtw_alloc_xmitbuf_ext(s
 {
 	long unsigned int irqL;
 	struct xmit_buf *pxmitbuf =  NULL;
-	_list *plist, *phead;
+	struct list_head *plist, *phead;
 	_queue *pfree_queue = &pxmitpriv->free_xmit_extbuf_queue;
 
 _func_enter_;
@@ -1925,7 +1925,7 @@ struct xmit_buf *rtw_alloc_xmitbuf(struc
 {
 	long unsigned int irqL;
 	struct xmit_buf *pxmitbuf =  NULL;
-	_list *plist, *phead;
+	struct list_head *plist, *phead;
 	_queue *pfree_xmitbuf_queue = &pxmitpriv->free_xmitbuf_queue;
 
 _func_enter_;
@@ -2041,7 +2041,7 @@ struct xmit_frame *rtw_alloc_xmitframe(s
 	*/
 
 	struct xmit_frame *pxframe = NULL;
-	_list *plist, *phead;
+	struct list_head *plist, *phead;
 	_queue *pfree_xmit_queue = &pxmitpriv->free_xmit_queue;
 	_adapter *padapter = pxmitpriv->adapter;
 
@@ -2146,7 +2146,7 @@ _func_exit_;
 
 void rtw_free_xmitframe_queue(struct xmit_priv *pxmitpriv, _queue *pframequeue)
 {
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	struct	xmit_frame	*pxmitframe;
 
 _func_enter_;
@@ -2186,7 +2186,7 @@ s32 rtw_xmitframe_enqueue(_adapter *pada
 
 static struct xmit_frame *dequeue_one_xmitframe(struct xmit_priv *pxmitpriv, struct hw_xmit *phwxmit, struct tx_servq *ptxservq, _queue *pframe_queue)
 {
-	_list	*xmitframe_plist, *xmitframe_phead;
+	struct list_head *xmitframe_plist, *xmitframe_phead;
 	struct	xmit_frame	*pxmitframe=NULL;
 
 	xmitframe_phead = get_list_head(pframe_queue);
@@ -2213,7 +2213,7 @@ static struct xmit_frame *dequeue_one_xm
 
 struct xmit_frame* rtw_dequeue_xframe(struct xmit_priv *pxmitpriv, struct hw_xmit *phwxmit_i, int entry)
 {
-	_list *sta_plist, *sta_phead;
+	struct list_head *sta_plist, *sta_phead;
 	struct hw_xmit *phwxmit;
 	struct tx_servq *ptxservq = NULL;
 	_queue *pframe_queue = NULL;
@@ -2952,7 +2952,7 @@ int xmitframe_enqueue_for_sleeping_sta(_
 
 static void dequeue_xmitframes_to_sleeping_queue(_adapter *padapter, struct sta_info *psta, _queue *pframequeue)
 {
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	u8	ac_index;
 	struct tx_servq	*ptxservq;
 	struct pkt_attrib	*pattrib;
@@ -3044,7 +3044,7 @@ void wakeup_sta_to_xmit(_adapter *padapt
 {
 	u8 update_mask=0, wmmps_ac=0;
 	struct sta_info *psta_bmc;
-	_list	*xmitframe_plist, *xmitframe_phead;
+	struct list_head *xmitframe_plist, *xmitframe_phead;
 	struct xmit_frame *pxmitframe=NULL;
 	struct sta_priv *pstapriv = &padapter->stapriv;
 
@@ -3209,7 +3209,7 @@ void wakeup_sta_to_xmit(_adapter *padapt
 void xmit_delivery_enabled_frames(_adapter *padapter, struct sta_info *psta)
 {
 	u8 wmmps_ac=0;
-	_list	*xmitframe_plist, *xmitframe_phead;
+	struct list_head *xmitframe_plist, *xmitframe_phead;
 	struct xmit_frame *pxmitframe=NULL;
 	struct sta_priv *pstapriv = &padapter->stapriv;
 
--- a/drivers/staging/rtl8192du/hal/rtl8192d_dm.c
+++ b/drivers/staging/rtl8192du/hal/rtl8192d_dm.c
@@ -1347,7 +1347,7 @@ static void PWDB_Monitor(
 
 	if(check_fwstate(&Adapter->mlmepriv, WIFI_AP_STATE|WIFI_ADHOC_STATE|WIFI_ADHOC_MASTER_STATE) == true)
 	{
-		_list	*plist, *phead;
+		struct list_head *plist, *phead;
 		struct sta_info *psta;
 		struct sta_priv *pstapriv = &Adapter->stapriv;
 		u8 bcast_addr[ETH_ALEN]= {0xff,0xff,0xff,0xff,0xff,0xff};
--- a/drivers/staging/rtl8192du/hal/rtl8192du_xmit.c
+++ b/drivers/staging/rtl8192du/hal/rtl8192du_xmit.c
@@ -618,7 +618,7 @@ void UpdateEarlyModeInfo8192D(_adapter *
 	u32	len;
 	struct xmit_priv	*pxmitpriv = &padapter->xmitpriv;
 	struct pkt_attrib	*pattrib = &pxmitframe->attrib;
-	_list *xmitframe_plist = NULL, *xmitframe_phead = NULL;
+	struct list_head *xmitframe_plist = NULL, *xmitframe_phead = NULL;
 
 	//Some macaddr can't do early mode.
 	if(MacAddr_isBcst(pattrib->dst) ||IS_MCAST(pattrib->dst) || !!pattrib->qos_en)
@@ -655,7 +655,7 @@ s32 rtl8192du_xmitframe_complete(_adapte
 	struct hw_xmit	*phwxmit = pxmitpriv->hwxmits;
 	struct tx_servq	*ptxservq = NULL;
 
-	_list *xmitframe_plist = NULL, *xmitframe_phead = NULL;
+	struct list_head *xmitframe_plist = NULL, *xmitframe_phead = NULL;
 
 	u32	pbuf=0; // next pkt address
 	u32	pbuf_tail; // last pkt tail
--- a/drivers/staging/rtl8192du/include/ieee80211.h
+++ b/drivers/staging/rtl8192du/include/ieee80211.h
@@ -298,7 +298,7 @@ struct ieee_ibss_seq {
 	u16 seq_num;
 	u16 frag_num;
 	unsigned long packet_time;
-	_list	list;
+	struct list_head list;
 };
 
 struct rtw_ieee80211_hdr {
--- a/drivers/staging/rtl8192du/include/osdep_service.h
+++ b/drivers/staging/rtl8192du/include/osdep_service.h
@@ -100,7 +100,6 @@
 	};
 
 	typedef struct	__queue	_queue;
-	typedef struct	list_head	_list;
 	typedef	int	_OS_STATUS;
 
 	typedef int		thread_return;
@@ -139,12 +138,12 @@ static inline unsigned char *skb_end_poi
 }
 #endif
 
-static inline _list *get_next(_list	*list)
+static inline struct list_head *get_next(struct list_head *list)
 {
 	return list->next;
 }
 
-static inline _list	*get_list_head(_queue	*queue)
+static inline struct list_head *get_list_head(_queue	*queue)
 {
 	return (&(queue->queue));
 }
@@ -172,7 +171,7 @@ static inline void _exit_critical_mutex(
 #endif
 }
 
-static inline void rtw_list_delete(_list *plist)
+static inline void rtw_list_delete(struct list_head *plist)
 {
 	list_del_init(plist);
 }
@@ -356,11 +355,11 @@ extern void	_rtw_memcpy(void* dec, void*
 extern int	_rtw_memcmp(void *dst, void *src, u32 sz);
 extern void	_rtw_memset(void *pbuf, int c, u32 sz);
 
-extern void	_rtw_init_listhead(_list *list);
-extern u32	rtw_is_list_empty(_list *phead);
-extern void	rtw_list_insert_head(_list *plist, _list *phead);
-extern void	rtw_list_insert_tail(_list *plist, _list *phead);
-extern void	rtw_list_delete(_list *plist);
+extern void	_rtw_init_listhead(struct list_head *list);
+extern u32	rtw_is_list_empty(struct list_head *phead);
+extern void	rtw_list_insert_head(struct list_head *plist, struct list_head *phead);
+extern void	rtw_list_insert_tail(struct list_head *plist, struct list_head *phead);
+extern void	rtw_list_delete(struct list_head *plist);
 
 extern void	_rtw_init_sema(struct  semaphore *sema, int init_val);
 extern void	_rtw_free_sema(struct  semaphore *sema);
@@ -377,7 +376,7 @@ extern void	_rtw_spinunlock_ex(spinlock_
 
 extern void	_rtw_init_queue(_queue	*pqueue);
 extern u32	_rtw_queue_empty(_queue	*pqueue);
-extern u32	rtw_end_of_queue_search(_list *queue, _list *pelement);
+extern u32	rtw_end_of_queue_search(struct list_head *queue, struct list_head *pelement);
 
 extern u32	rtw_get_current_time(void);
 extern u32	rtw_systime_to_ms(u32 systime);
--- a/drivers/staging/rtl8192du/include/rtw_cmd.h
+++ b/drivers/staging/rtl8192du/include/rtw_cmd.h
@@ -47,7 +47,7 @@
 		u32	cmdsz;
 		u8	*rsp;
 		u32	rspsz;
-		_list	list;
+		struct list_head list;
 	};
 
 	struct cmd_priv {
@@ -72,7 +72,7 @@
 		u8	res;
 		u8	*parmbuf;
 		u32	evtsz;
-		_list	list;
+		struct list_head list;
 	};
 #endif
 
--- a/drivers/staging/rtl8192du/include/rtw_io.h
+++ b/drivers/staging/rtl8192du/include/rtw_io.h
@@ -151,7 +151,7 @@ struct _io_ops
 };
 
 struct io_req {
-	_list	list;
+	struct list_head list;
 	u32	addr;
 	volatile u32	val;
 	u32	command;
@@ -290,9 +290,9 @@ Below is the data structure used by _io_
 
 struct io_queue {
 	spinlock_t lock;
-	_list	free_ioreqs;
-	_list		pending;		//The io_req list that will be served in the single protocol read/write.
-	_list		processing;
+	struct list_head free_ioreqs;
+	struct list_head pending;		//The io_req list that will be served in the single protocol read/write.
+	struct list_head processing;
 	u8	*free_ioreqs_buf; // 4-byte aligned
 	u8	*pallocated_free_ioreqs_buf;
 	struct	intf_hdl	intf;
--- a/drivers/staging/rtl8192du/include/rtw_mlme.h
+++ b/drivers/staging/rtl8192du/include/rtw_mlme.h
@@ -389,7 +389,7 @@ struct mlme_priv {
 	u8	*nic_hdl;
 
 	u8	not_indic_disco;
-	_list		*pscanned;
+	struct list_head *pscanned;
 	_queue	free_bss_pool;
 	_queue	scanned_queue;
 	u8		*free_bss_buf;
--- a/drivers/staging/rtl8192du/include/rtw_mp.h
+++ b/drivers/staging/rtl8192du/include/rtw_mp.h
@@ -84,7 +84,7 @@
 #define NR_MP_XMITFRAME		8
 
 struct mp_xmit_frame {
-	_list	list;
+	struct list_head list;
 	struct pkt_attrib attrib;
 	struct sk_buff *pkt;
 	int frame_tag;
--- a/drivers/staging/rtl8192du/include/rtw_recv.h
+++ b/drivers/staging/rtl8192du/include/rtw_recv.h
@@ -288,7 +288,7 @@ struct sta_recv_priv {
 
 
 struct recv_buf {
-	_list list;
+	struct list_head list;
 
 	spinlock_t recvbuf_lock;
 
@@ -331,7 +331,7 @@ struct recv_buf {
 */
 struct recv_frame_hdr
 {
-	_list	list;
+	struct list_head list;
 #ifndef CONFIG_BSD_RX_USE_MBUF
 	struct sk_buff	 *pkt;
 	struct sk_buff	 *pkt_newalloc;
@@ -367,15 +367,11 @@ struct recv_frame_hdr
 
 
 union recv_frame{
-
 	union{
-		_list list;
+		struct list_head list;
 		struct recv_frame_hdr hdr;
 		uint mem[RECVFRAME_HDR_ALIGN>>2];
-	}u;
-
-	//uint mem[MAX_RXSZ>>2];
-
+	} u;
 };
 
 
--- a/drivers/staging/rtl8192du/include/rtw_xmit.h
+++ b/drivers/staging/rtl8192du/include/rtw_xmit.h
@@ -263,7 +263,7 @@ void rtw_sctx_done(struct submit_ctx **s
 
 struct xmit_buf
 {
-	_list	list;
+	struct list_head list;
 
 	_adapter *padapter;
 
@@ -289,7 +289,7 @@ struct xmit_buf
 };
 
 struct xmit_frame {
-	_list	list;
+	struct list_head list;
 	struct pkt_attrib attrib;
 	struct sk_buff *pkt;
 	int	frame_tag;
@@ -308,7 +308,7 @@ struct xmit_frame {
 };
 
 struct tx_servq {
-	_list	tx_pending;
+	struct list_head tx_pending;
 	_queue	sta_pending;
 	int qcnt;
 };
@@ -323,8 +323,8 @@ struct sta_xmit_priv {
 	struct tx_servq	bk_q;			//priority == 1,2
 	struct tx_servq	vi_q;			//priority == 4,5
 	struct tx_servq	vo_q;			//priority == 6,7
-	_list	legacy_dz;
-	_list  apsd;
+	struct list_head legacy_dz;
+	struct list_head apsd;
 	u16 txseq_tid[16];
 };
 
--- a/drivers/staging/rtl8192du/include/sta_info.h
+++ b/drivers/staging/rtl8192du/include/sta_info.h
@@ -33,7 +33,7 @@
 //if mode ==0, then the sta is allowed once the addr is hit.
 //if mode ==1, then the sta is rejected once the addr is non-hit.
 struct rtw_wlan_acl_node {
-        _list		        list;
+        struct list_head list;
         u8       addr[ETH_ALEN];
         u8       valid;
 };
@@ -93,14 +93,9 @@ struct TDLS_PeerKey {
 #endif //CONFIG_TDLS
 
 struct sta_info {
-
 	spinlock_t lock;
-	_list	list; //free_sta_queue
-	_list	hash_list; //sta_hash
-	//_list asoc_list; //20061114
-	//_list sleep_list;//sleep_q
-	//_list wakeup_list;//wakeup_q
-
+	struct list_head list; //free_sta_queue
+	struct list_head hash_list; //sta_hash
 	struct sta_xmit_priv sta_xmitpriv;
 	struct sta_recv_priv sta_recvpriv;
 
@@ -187,8 +182,8 @@ struct sta_info {
 
 #ifdef CONFIG_AP_MODE
 
-	_list asoc_list;
-	_list auth_list;
+	struct list_head asoc_list;
+	struct list_head auth_list;
 
 	unsigned int expire_to;
 	unsigned int auth_seq;
@@ -353,7 +348,7 @@ struct	sta_priv {
 	_queue	free_sta_queue;
 
 	spinlock_t sta_hash_lock;
-	_list   sta_hash[NUM_STA];
+	struct list_head sta_hash[NUM_STA];
 	int asoc_sta_count;
 	_queue sleep_q;
 	_queue wakeup_q;
@@ -362,8 +357,8 @@ struct	sta_priv {
 
 
 #ifdef CONFIG_AP_MODE
-	_list asoc_list;
-	_list auth_list;
+	struct list_head asoc_list;
+	struct list_head auth_list;
 	spinlock_t asoc_list_lock;
 	spinlock_t auth_list_lock;
 	u8 asoc_list_cnt;
--- a/drivers/staging/rtl8192du/include/wlan_bssdef.h
+++ b/drivers/staging/rtl8192du/include/wlan_bssdef.h
@@ -272,7 +272,7 @@ __inline  static uint get_WLAN_BSSID_EX_
 }
 
 struct	wlan_network {
-	_list	list;
+	struct list_head list;
 	int	network_type;	//refer to ieee80211.h for WIRELESS_11A/B/G
 	int	fixed;			// set to fixed when not to be removed as site-surveying
 	unsigned long	last_scanned; //timestamp for the network
--- a/drivers/staging/rtl8192du/os_dep/ioctl_linux.c
+++ b/drivers/staging/rtl8192du/os_dep/ioctl_linux.c
@@ -1511,7 +1511,7 @@ static int rtw_wx_set_wap(struct net_dev
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
 	struct sockaddr *temp = (struct sockaddr *)awrq;
 	struct	mlme_priv	*pmlmepriv = &(padapter->mlmepriv);
-	_list	*phead;
+	struct list_head *phead;
 	u8 *dst_bssid, *src_bssid;
 	_queue	*queue	= &(pmlmepriv->scanned_queue);
 	struct	wlan_network	*pnetwork = NULL;
@@ -1927,7 +1927,7 @@ _func_exit_;
 static int rtw_wx_get_scan(struct net_device *dev, struct iw_request_info *a,
 			     union iwreq_data *wrqu, char *extra)
 {
-	_list					*plist, *phead;
+	struct list_head *plist, *phead;
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
 	struct	mlme_priv	*pmlmepriv = &(padapter->mlmepriv);
 	_queue				*queue	= &(pmlmepriv->scanned_queue);
@@ -2089,7 +2089,7 @@ static int rtw_wx_set_essid(struct net_d
 	struct mlme_priv *pmlmepriv = &padapter->mlmepriv;
 	_queue *queue = &pmlmepriv->scanned_queue;
 	struct pwrctrl_priv *pwrpriv = &padapter->pwrctrlpriv;
-	_list *phead;
+	struct list_head *phead;
 	s8 status = true;
 	struct wlan_network *pnetwork = NULL;
 	enum NDIS_802_11_AUTHENTICATION_MODE authmode;
@@ -3512,7 +3512,7 @@ static int rtw_get_ap_info(struct net_de
 {
 	int bssid_match, ret = 0;
 	u32 cnt=0, wpa_ielen;
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	unsigned char *pbuf;
 	u8 bssid[ETH_ALEN];
 	char data[32];
@@ -4194,7 +4194,7 @@ static int rtw_p2p_get_wps_configmethod(
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
 	u8 peerMAC[ETH_ALEN] = { 0x00 };
 	struct mlme_priv *pmlmepriv = &padapter->mlmepriv;
-	_list * plist,*phead;
+	struct list_head *plist, *phead;
 	_queue *queue = &(pmlmepriv->scanned_queue);
 	struct wlan_network *pnetwork = NULL;
 	u8 blnMatch = 0;
@@ -4330,7 +4330,7 @@ static int rtw_p2p_get_go_device_address
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
 	u8 peerMAC[ETH_ALEN] = { 0x00 };
 	struct mlme_priv *pmlmepriv = &padapter->mlmepriv;
-	_list *plist, *phead;
+	struct list_head *plist, *phead;
 	_queue *queue	= &(pmlmepriv->scanned_queue);
 	struct wlan_network *pnetwork = NULL;
 	u8 blnMatch = 0;
@@ -4421,7 +4421,7 @@ static int rtw_p2p_get_device_type(struc
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
 	u8 peerMAC[ETH_ALEN] = { 0x00 };
 	struct mlme_priv *pmlmepriv = &padapter->mlmepriv;
-	_list *plist, *phead;
+	struct list_head *plist, *phead;
 	_queue *queue = &(pmlmepriv->scanned_queue);
 	struct wlan_network *pnetwork = NULL;
 	u8 blnMatch = 0;
@@ -4498,7 +4498,7 @@ static int rtw_p2p_get_device_name(struc
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
 	u8 peerMAC[ETH_ALEN] = { 0x00 };
 	struct mlme_priv *pmlmepriv = &padapter->mlmepriv;
-	_list *plist, *phead;
+	struct list_head *plist, *phead;
 	_queue *queue = &(pmlmepriv->scanned_queue);
 	struct wlan_network *pnetwork = NULL;
 	u8 blnMatch = 0;
@@ -4571,7 +4571,7 @@ static int rtw_p2p_get_invitation_proced
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
 	u8 peerMAC[ETH_ALEN] = { 0x00 };
 	struct mlme_priv *pmlmepriv = &padapter->mlmepriv;
-	_list *plist, *phead;
+	struct list_head *plist, *phead;
 	_queue *queue	= &(pmlmepriv->scanned_queue);
 	struct wlan_network *pnetwork = NULL;
 	u8 blnMatch = 0;
@@ -4662,7 +4662,7 @@ static int rtw_p2p_connect(struct net_de
 	int					jj,kk;
 	u8					peerMACStr[ ETH_ALEN * 2 ] = { 0x00 };
 	struct mlme_priv		*pmlmepriv = &padapter->mlmepriv;
-	_list					*plist, *phead;
+	struct list_head *plist, *phead;
 	_queue				*queue	= &(pmlmepriv->scanned_queue);
 	struct	wlan_network	*pnetwork = NULL;
 	uint					uintPeerChannel = 0;
@@ -4794,7 +4794,7 @@ static int rtw_p2p_invite_req(struct net
 	int						jj,kk;
 	u8						peerMACStr[ ETH_ALEN * 2 ] = { 0x00 };
 	struct mlme_priv			*pmlmepriv = &padapter->mlmepriv;
-	_list						*plist, *phead;
+	struct list_head *plist, *phead;
 	_queue					*queue	= &(pmlmepriv->scanned_queue);
 	struct	wlan_network		*pnetwork = NULL;
 	uint						uintPeerChannel = 0;
@@ -5015,7 +5015,7 @@ static int rtw_p2p_set_persistent(struct
 	int						jj,kk;
 	u8						peerMACStr[ ETH_ALEN * 2 ] = { 0x00 };
 	struct mlme_priv			*pmlmepriv = &padapter->mlmepriv;
-	_list						*plist, *phead;
+	struct list_head *plist, *phead;
 	_queue					*queue	= &(pmlmepriv->scanned_queue);
 	struct	wlan_network		*pnetwork = NULL;
 	uint						uintPeerChannel = 0;
@@ -5082,7 +5082,7 @@ static int rtw_p2p_set_pc(struct net_dev
 	int					jj,kk;
 	u8					peerMACStr[ ETH_ALEN * 2 ] = { 0x00 };
 	struct mlme_priv		*pmlmepriv = &padapter->mlmepriv;
-	_list					*plist, *phead;
+	struct list_head *plist, *phead;
 	_queue				*queue	= &(pmlmepriv->scanned_queue);
 	struct	wlan_network	*pnetwork = NULL;
 	u8					attr_content[50] = { 0x00 }, _status = 0;
@@ -5335,7 +5335,7 @@ static int rtw_p2p_prov_disc(struct net_
 	int					jj,kk;
 	u8					peerMACStr[ ETH_ALEN * 2 ] = { 0x00 };
 	struct mlme_priv		*pmlmepriv = &padapter->mlmepriv;
-	_list					*plist, *phead;
+	struct list_head *plist, *phead;
 	_queue				*queue	= &(pmlmepriv->scanned_queue);
 	struct	wlan_network	*pnetwork = NULL;
 	uint					uintPeerChannel = 0;
@@ -6298,7 +6298,7 @@ static int rtw_dbg_port(struct net_devic
 				case 0x09:
 					{
 						int i, j;
-						_list	*plist, *phead;
+						struct list_head *plist, *phead;
 						struct recv_reorder_ctrl *preorder_ctrl;
 
 #ifdef CONFIG_AP_MODE
@@ -7218,11 +7218,8 @@ static int rtw_set_beacon(struct net_dev
 
 static int rtw_hostapd_sta_flush(struct net_device *dev)
 {
-	//_list	*phead, *plist;
 	int ret=0;
-	//struct sta_info *psta = NULL;
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
-	//struct sta_priv *pstapriv = &padapter->stapriv;
 
 	DBG_8192D("%s\n", __func__);
 
@@ -9605,7 +9602,7 @@ static int rtw_tdls_enable(struct net_de
 
 	_adapter *padapter = (_adapter *)rtw_netdev_priv(dev);
 	struct tdls_info	*ptdlsinfo = &padapter->tdlsinfo;
-	_list	*plist, *phead;
+	struct list_head *plist, *phead;
 	s32	index;
 	struct sta_info *psta = NULL;
 	struct	sta_priv *pstapriv = &padapter->stapriv;
--- a/drivers/staging/rtl8192du/os_dep/osdep_service.c
+++ b/drivers/staging/rtl8192du/os_dep/osdep_service.c
@@ -394,7 +394,7 @@ void _rtw_memset(void *pbuf, int c, u32
         memset(pbuf, c, sz);
 }
 
-void _rtw_init_listhead(_list *list)
+void _rtw_init_listhead(struct list_head *list)
 {
         INIT_LIST_HEAD(list);
 }
@@ -404,7 +404,7 @@ For the following list_xxx operations,
 caller must guarantee the atomic context.
 Otherwise, there will be racing condition.
 */
-u32	rtw_is_list_empty(_list *phead)
+u32	rtw_is_list_empty(struct list_head *phead)
 {
 	if (list_empty(phead))
 		return true;
@@ -412,12 +412,12 @@ u32	rtw_is_list_empty(_list *phead)
 		return false;
 }
 
-void rtw_list_insert_head(_list *plist, _list *phead)
+void rtw_list_insert_head(struct list_head *plist, struct list_head *phead)
 {
 	list_add(plist, phead);
 }
 
-void rtw_list_insert_tail(_list *plist, _list *phead)
+void rtw_list_insert_tail(struct list_head *plist, struct list_head *phead)
 {
 	list_add_tail(plist, phead);
 }
@@ -509,7 +509,7 @@ u32	  _rtw_queue_empty(_queue	*pqueue)
 }
 
 
-u32 rtw_end_of_queue_search(_list *head, _list *plist)
+u32 rtw_end_of_queue_search(struct list_head *head, struct list_head *plist)
 {
 	if (head == plist)
 		return true;
--- a/drivers/staging/rtl8192du/os_dep/xmit_linux.c
+++ b/drivers/staging/rtl8192du/os_dep/xmit_linux.c
@@ -246,7 +246,7 @@ int rtw_mlcst2unicst(_adapter *padapter,
 {
 	struct	sta_priv *pstapriv = &padapter->stapriv;
 	struct xmit_priv *pxmitpriv = &padapter->xmitpriv;
-	_list	*phead, *plist;
+	struct list_head *phead, *plist;
 	struct sk_buff *newskb;
 	struct sta_info *psta = NULL;
 	s32	res;
