From 37a7c0c09e3b365a5f147e97b2396304beae3063 Mon Sep 17 00:00:00 2001
From: Larry Finger <Larry.Finger@lwfinger.net>
Date: Fri, 3 May 2013 10:52:52 -0500
Subject: [PATCH 107/390] Revert commit 337de20

Signed-off-by: Larry Finger <Larry.Finger@lwfinger.net>
---
 core/rtw_sta_mgt.c     |  2 +-
 core/rtw_wlan_util.c   |  2 +-
 include/rtw_mlme_ext.h |  1 -
 include/rtw_mp.h       |  2 +-
 include/wlan_bssdef.h  | 24 +++++++++++++-----------
 5 files changed, 16 insertions(+), 15 deletions(-)

--- a/drivers/staging/rtl8192du/core/rtw_sta_mgt.c
+++ b/drivers/staging/rtl8192du/core/rtw_sta_mgt.c
@@ -670,7 +670,7 @@ u32 rtw_init_bcmc_stainfo(struct rtw_ada
 	struct sta_info		*psta;
 	struct tx_servq	*ptxservq;
 	u32 res=_SUCCESS;
-	unsigned char bcast_addr[ETH_ALEN]= {0xff,0xff,0xff,0xff,0xff,0xff};
+	NDIS_802_11_MAC_ADDRESS	bcast_addr= {0xff,0xff,0xff,0xff,0xff,0xff};
 
 	struct	sta_priv *pstapriv = &padapter->stapriv;
 
--- a/drivers/staging/rtl8192du/core/rtw_wlan_util.c
+++ b/drivers/staging/rtl8192du/core/rtw_wlan_util.c
@@ -1573,7 +1573,7 @@ void set_sta_rate(struct rtw_adapter *pa
 // Update RRSR and Rate for USERATE
 void update_tx_basic_rate(struct rtw_adapter *padapter, u8 wirelessmode)
 {
-	unsigned char supported_rates[NDIS_802_11_LENGTH_RATES];
+	NDIS_802_11_RATES_EX	supported_rates;
 	struct mlme_ext_priv	*pmlmeext = &padapter->mlmeextpriv;
 #ifdef CONFIG_P2P
 	struct wifidirect_info*	pwdinfo = &padapter->wdinfo;
--- a/drivers/staging/rtl8192du/include/rtw_mlme_ext.h
+++ b/drivers/staging/rtl8192du/include/rtw_mlme_ext.h
@@ -25,7 +25,6 @@
 #include <drv_types.h>
 #include <wlan_bssdef.h>
 
-typedef unsigned char   NDIS_802_11_RATES_EX[NDIS_802_11_LENGTH_RATES_EX];
 
 //	Commented by Albert 20101105
 //	Increase the SURVEY_TO value from 100 to 150  ( 100ms to 150ms )
--- a/drivers/staging/rtl8192du/include/rtw_mp.h
+++ b/drivers/staging/rtl8192du/include/rtw_mp.h
@@ -282,7 +282,7 @@ struct mp_priv
 //	uint ForcedDataRate;
 
 	struct wlan_network mp_network;
-	unsigned char network_macaddr[ETH_ALEN];
+	NDIS_802_11_MAC_ADDRESS network_macaddr;
 
 	u8 *pallocated_mp_xmitframe_buf;
 	u8 *pmp_xmtframe_buf;
--- a/drivers/staging/rtl8192du/include/wlan_bssdef.h
+++ b/drivers/staging/rtl8192du/include/wlan_bssdef.h
@@ -27,7 +27,9 @@
 #define NDIS_802_11_LENGTH_RATES        8
 #define NDIS_802_11_LENGTH_RATES_EX     16
 
+typedef unsigned char   NDIS_802_11_MAC_ADDRESS[6];
 typedef unsigned char   NDIS_802_11_RATES_EX[NDIS_802_11_LENGTH_RATES_EX];  // Set of 16 data rates
+typedef long		NDIS_802_11_RSSI;           // in dBm
 
 struct ndis_802_11_ssid {
 	u32  SsidLength;
@@ -83,9 +85,9 @@ struct ndis_802_11_variable_ies {
 
 /*
 Length is the 4 bytes multiples of the sume of
-	ETH_ALEN + 2 + sizeof (struct ndis_802_11_ssid) + sizeof (u32)
-+   sizeof (long) + sizeof (NDIS_802_11_NETWORK_TYPE) + sizeof (struct ndis_802_11_config)
-+   sizeof (NDIS_802_11_LENGTH_RATES * sizeof(unsigned char)) + IELength
+	sizeof (NDIS_802_11_MAC_ADDRESS) + 2 + sizeof (struct ndis_802_11_ssid) + sizeof (u32)
++   sizeof (NDIS_802_11_RSSI) + sizeof (NDIS_802_11_NETWORK_TYPE) + sizeof (struct ndis_802_11_config)
++   sizeof (NDIS_802_11_RATES_EX) + IELength
 
 Except the IELength, all other fields are fixed length. Therefore, we can define a marco to present the
 partial sum.
@@ -127,7 +129,7 @@ enum NDIS_802_11_ENCRYPTION_STATUS {
 struct ndis_802_11_ai_reqfi {
     u16 Capabilities;
     u16 ListenInterval;
-    unsigned char CurrentAPAddress[ETH_ALEN];
+    NDIS_802_11_MAC_ADDRESS  CurrentAPAddress;
 };
 
 struct ndis_802_11_ai_resfi {
@@ -153,7 +155,7 @@ struct ndis_802_11_key {
     u32           Length;             // Length of this structure
     u32           KeyIndex;
     u32           KeyLength;          // length of key in bytes
-    unsigned char BSSID[ETH_ALEN];
+    NDIS_802_11_MAC_ADDRESS BSSID;
     unsigned long long KeyRSC;
     u8           KeyMaterial[32];     // variable length depending on above field
 };
@@ -161,7 +163,7 @@ struct ndis_802_11_key {
 struct ndis_802_11_remove_key {
     u32                   Length;        // Length of this structure
     u32                   KeyIndex;
-    unsigned char  BSSID[ETH_ALEN];
+    NDIS_802_11_MAC_ADDRESS BSSID;
 };
 
 struct ndis_802_11_wep {
@@ -173,7 +175,7 @@ struct ndis_802_11_wep {
 
 struct ndis_802_11_auth_req {
     u32 Length;            // Length of structure
-    unsigned char  Bssid[ETH_ALEN];
+    NDIS_802_11_MAC_ADDRESS Bssid;
     u32 Flags;
 };
 
@@ -208,7 +210,7 @@ struct ndis_802_11_test {
     u32 Type;
     union {
         struct ndis_802_11_auth_event AuthenticationEvent;
-        long RssiTrigger;
+        NDIS_802_11_RSSI RssiTrigger;
     } tt;
 };
 
@@ -225,11 +227,11 @@ struct wlan_phy_info {
 
 struct wlan_bssid_ex {
 	u32  Length;
-	unsigned char MacAddress[ETH_ALEN];
+	NDIS_802_11_MAC_ADDRESS  MacAddress;
 	u8  Reserved[2];//[0]: IS beacon frame
 	struct ndis_802_11_ssid  Ssid;
 	u32  Privacy;
-	long  Rssi;//(in dBM,raw data ,get from PHY)
+	NDIS_802_11_RSSI  Rssi;//(in dBM,raw data ,get from PHY)
 	enum NDIS_802_11_NETWORK_TYPE  NetworkTypeInUse;
 	struct ndis_802_11_config  Configuration;
 	enum NDIS_802_11_NETWORK_INFRASTRUCTURE  InfrastructureMode;
@@ -296,7 +298,7 @@ enum UAPSD_MAX_SP
 */
 
 struct pmkid_candidate {
-	unsigned char  BSSID[ETH_ALEN];
+	NDIS_802_11_MAC_ADDRESS BSSID;
 	u32 Flags;
 };
 
