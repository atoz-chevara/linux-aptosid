From 8c7634a34d8d74809181d5448da89d2eaae1cdf7 Mon Sep 17 00:00:00 2001
From: Larry Finger <Larry.Finger@lwfinger.net>
Date: Wed, 17 Apr 2013 00:23:17 -0500
Subject: [PATCH 006/210] Remove more dead code

Signed-off-by: Larry Finger <Larry.Finger@lwfinger.net>
---
 core/rtw_br_ext.c        |   32 -
 core/rtw_efuse.c         |   12 -
 core/rtw_mlme_ext.c      |  296 +--------
 core/rtw_mp_ioctl.c      | 1566 ++++------------------------------------------
 core/rtw_p2p.c           |   30 +-
 core/rtw_pwrctrl.c       |   12 -
 core/rtw_wlan_util.c     |  288 +--------
 hal/usb_halinit.c        |  227 ++-----
 15 files changed, 190 insertions(+), 2275 deletions(-)

--- a/drivers/staging/rtl8192du/core/rtw_br_ext.c
+++ b/drivers/staging/rtl8192du/core/rtw_br_ext.c
@@ -1567,38 +1567,6 @@ int nat25_handle_frame(_adapter *priv, s
 	return 0;
 }
 
-#if 0
-void mac_clone(_adapter *priv, unsigned char *addr)
-{
-	struct sockaddr sa;
-
-	memcpy(sa.sa_data, addr, ETH_ALEN);
-	DEBUG_INFO("MAC Clone: Addr=%02x%02x%02x%02x%02x%02x\n",
-		addr[0], addr[1], addr[2], addr[3], addr[4], addr[5]);
-	rtl8192cd_set_hwaddr(priv->dev, &sa);
-}
-
-
-int mac_clone_handle_frame(_adapter *priv, struct sk_buff *skb)
-{
-	if(priv->ethBrExtInfo.macclone_enable && !priv->macclone_completed)
-	{
-		if(!(skb->data[ETH_ALEN] & 1))	//// check any other particular MAC add
-		{
-                        if(memcmp(skb->data+ETH_ALEN, GET_MY_HWADDR(priv), ETH_ALEN) &&
-				((priv->dev->br_port) &&
-				 memcmp(skb->data+ETH_ALEN, priv->br_mac, ETH_ALEN)))
-			{
-				mac_clone(priv, skb->data+ETH_ALEN);
-				priv->macclone_completed = 1;
-			}
-		}
-	}
-
-	return 0;
-}
-#endif // 0
-
 #define SERVER_PORT			67
 #define CLIENT_PORT			68
 #define DHCP_MAGIC			0x63825363
--- a/drivers/staging/rtl8192du/core/rtw_efuse.c
+++ b/drivers/staging/rtl8192du/core/rtw_efuse.c
@@ -1086,9 +1086,7 @@ Efuse_InitSomeVar(
 	_rtw_memset((PVOID)&fakeBTEfuseModifiedMap[0], 0xff, EFUSE_BT_MAX_MAP_LEN);
 }
 
-#ifdef PLATFORM_LINUX
 #ifdef CONFIG_ADAPTOR_INFO_CACHING_FILE
-//#include <rtw_eeprom.h>
 
  int isAdaptorInfoFileValid(void)
 {
@@ -1126,15 +1124,6 @@ int retriveAdaptorInfoFile(char *path, s
 			ret = _SUCCESS;
 		else
 			ret = _FAIL;
-
-		#if 0
-		if(isAdaptorInfoFileValid()) {
-			return 0;
-		} else {
-			return _FAIL;
-		}
-		#endif
-
 	} else {
 		DBG_871X("%s NULL pointer\n",__FUNCTION__);
 		ret = _FAIL;
@@ -1142,4 +1131,3 @@ int retriveAdaptorInfoFile(char *path, s
 	return ret;
 }
 #endif //CONFIG_ADAPTOR_INFO_CACHING_FILE
-#endif //PLATFORM_LINUX
--- a/drivers/staging/rtl8192du/core/rtw_mlme_ext.c
+++ b/drivers/staging/rtl8192du/core/rtw_mlme_ext.c
@@ -366,10 +366,6 @@ static void init_channel_list(_adapter *
 	struct p2p_oper_class_map op_class[] = {
 		{ IEEE80211G,  81,   1,  13,  1, BW20 },
 		{ IEEE80211G,  82,  14,  14,  1, BW20 },
-#if 0 /* Do not enable HT40 on 2 GHz */
-		{ IEEE80211G,  83,   1,   9,  1, BW40PLUS },
-		{ IEEE80211G,  84,   5,  13,  1, BW40MINUS },
-#endif
 		{ IEEE80211A, 115,  36,  48,  4, BW20 },
 		{ IEEE80211A, 116,  36,  44,  8, BW40PLUS },
 		{ IEEE80211A, 117,  40,  48,  8, BW40MINUS },
@@ -627,18 +623,6 @@ void mgt_dispatcher(_adapter *padapter,
 		 ("+mgt_dispatcher: type(0x%x) subtype(0x%x)\n",
 		  GetFrameType(pframe), GetFrameSubType(pframe)));
 
-#if 0
-	{
-		u8 *pbuf;
-		pbuf = GetAddr1Ptr(pframe);
-		DBG_871X("A1-%x:%x:%x:%x:%x:%x\n", *pbuf, *(pbuf+1), *(pbuf+2), *(pbuf+3), *(pbuf+4), *(pbuf+5));
-		pbuf = GetAddr2Ptr(pframe);
-		DBG_871X("A2-%x:%x:%x:%x:%x:%x\n", *pbuf, *(pbuf+1), *(pbuf+2), *(pbuf+3), *(pbuf+4), *(pbuf+5));
-		pbuf = GetAddr3Ptr(pframe);
-		DBG_871X("A3-%x:%x:%x:%x:%x:%x\n", *pbuf, *(pbuf+1), *(pbuf+2), *(pbuf+3), *(pbuf+4), *(pbuf+5));
-	}
-#endif
-
 	if (GetFrameType(pframe) != WIFI_MGT_TYPE)
 	{
 		RT_TRACE(_module_rtl871x_mlme_c_, _drv_err_, ("mgt_dispatcher: type(0x%x) error!\n", GetFrameType(pframe)));
@@ -984,19 +968,6 @@ unsigned int OnProbeRsp(_adapter *padapt
 		return _SUCCESS;
 	}
 
-	#if 0 //move to validate_recv_mgnt_frame
-	if (_rtw_memcmp(GetAddr3Ptr(pframe), get_my_bssid(&pmlmeinfo->network), ETH_ALEN))
-	{
-		if (pmlmeinfo->state & WIFI_FW_ASSOC_SUCCESS)
-		{
-			if ((psta = rtw_get_stainfo(pstapriv, GetAddr2Ptr(pframe))) != NULL)
-			{
-				psta->sta_stats.rx_mgnt_pkts++;
-			}
-		}
-	}
-	#endif
-
 	return _SUCCESS;
 
 }
@@ -1078,34 +1049,18 @@ unsigned int OnBeacon(_adapter *padapter
 				process_p2p_ps_ie(padapter, (pframe + WLAN_HDR_A3_LEN), (len - WLAN_HDR_A3_LEN));
 #endif //CONFIG_P2P_PS
 
-				#if 0 //move to validate_recv_mgnt_frame
-				psta->sta_stats.rx_mgnt_pkts++;
-				#endif
 			}
-		}
-		else if((pmlmeinfo->state&0x03) == WIFI_FW_ADHOC_STATE)
-		{
-			if ((psta = rtw_get_stainfo(pstapriv, GetAddr2Ptr(pframe))) != NULL)
-			{
+		} else if((pmlmeinfo->state&0x03) == WIFI_FW_ADHOC_STATE) {
+			if ((psta = rtw_get_stainfo(pstapriv, GetAddr2Ptr(pframe))) != NULL) {
 				//update WMM, ERP in the beacon
 				//todo: the timer is used instead of the number of the beacon received
 				if ((sta_rx_pkts(psta) & 0xf) == 0)
-				{
-					//DBG_871X("update_bcn_info\n");
 					update_beacon_info(padapter, pframe, len, psta);
-				}
 
-				#if 0 //move to validate_recv_mgnt_frame
-				psta->sta_stats.rx_mgnt_pkts++;
-				#endif
-			}
-			else
-			{
+			} else {
 				//allocate a new CAM entry for IBSS station
 				if ((cam_idx = allocate_fw_sta_entry(padapter)) == NUM_STA)
-				{
 					goto _END_ONBEACON_;
-				}
 
 				//get supported rate
 				if (update_sta_support_rate(padapter, (pframe + WLAN_HDR_A3_LEN + _BEACON_IE_OFFSET_), (len - WLAN_HDR_A3_LEN - _BEACON_IE_OFFSET_), cam_idx) == _FAIL)
@@ -1169,23 +1124,6 @@ unsigned int OnAuth(_adapter *padapter,
 
 	if (GetPrivacy(pframe))
 	{
-#if 0 //TODO: SW rtw_wep_decrypt
-		if (SWCRYPTO)
-		{
-			status = rtw_wep_decrypt(priv, pframe, pfrinfo->pktlen,
-				priv->pmib->dot1180211AuthEntry.dot11PrivacyAlgrthm);
-			if (status == FALSE)
-			{
-				SAVE_INT_AND_CLI(flags);
-				RT_TRACE(_module_rtl871x_mlme_c_,_drv_err_,"wep-decrypt a Auth frame error!\n");
-				status = _STATS_CHALLENGE_FAIL_;
-				goto auth_fail;
-			}
-		}
-
-		seq = cpu_to_le16(*(unsigned short *)((unsigned int)pframe + WLAN_HDR_A3_LEN + 4 + 2));
-		algorithm = cpu_to_le16(*(unsigned short *)((unsigned int)pframe + WLAN_HDR_A3_LEN + 4));
-#endif
 	}
 
 
@@ -1207,46 +1145,13 @@ unsigned int OnAuth(_adapter *padapter,
 		goto auth_fail;
 	}
 
-#if 0 //ACL control
-	phead = &priv->wlan_acl_list;
-	plist = phead->next;
-	//check sa
-	if (acl_mode == 1)		// 1: positive check, only those on acl_list can be connected.
-		res = FAIL;
-	else
-		res = SUCCESS;
-
-	while(plist != phead)
-	{
-		paclnode = list_entry(plist, struct rtw_wlan_acl_node, list);
-		plist = plist->next;
-		if (!memcmp((void *)sa, paclnode->addr, 6)) {
-			if (paclnode->mode & 2) { // deny
-				res = FAIL;
-				break;
-			}
-			else {
-				res = SUCCESS;
-				break;
-			}
-		}
-	}
-
-	if (res != SUCCESS) {
-		RT_TRACE(_module_rtl871x_mlme_c_,_drv_err_,"auth abort because ACL!\n");
-		return FAIL;
-	}
-#else
-	if(rtw_access_ctrl(padapter, sa) == _FALSE)
-	{
+	if(rtw_access_ctrl(padapter, sa) == _FALSE) {
 		status = _STATS_UNABLE_HANDLE_STA_;
 		goto auth_fail;
 	}
-#endif
 
 	pstat = rtw_get_stainfo(pstapriv, sa);
-	if (pstat == NULL)
-	{
+	if (pstat == NULL) {
 		// allocate a new one
 		DBG_871X("going to alloc stainfo for sa="MAC_FMT"\n",  MAC_ARG(sa));
 		pstat = rtw_alloc_stainfo(pstapriv, sa);
@@ -1259,15 +1164,9 @@ unsigned int OnAuth(_adapter *padapter,
 
 		pstat->state = WIFI_FW_AUTH_NULL;
 		pstat->auth_seq = 0;
-
-		//pstat->flags = 0;
-		//pstat->capability = 0;
-	}
-	else
-	{
+	} else {
 		_enter_critical_bh(&pstapriv->asoc_list_lock, &irqL);
-		if(rtw_is_list_empty(&pstat->asoc_list)==_FALSE)
-		{
+		if(rtw_is_list_empty(&pstat->asoc_list)==_FALSE) {
 			rtw_list_delete(&pstat->asoc_list);
 			pstapriv->asoc_list_cnt--;
 			if (pstat->expire_to > 0)
@@ -1604,30 +1503,8 @@ unsigned int OnAssocReq(_adapter *padapt
 		pstat->state |= WIFI_FW_ASSOC_STATE;
 	}
 
-
-#if 0// todo:tkip_countermeasures
-	if (hapd->tkip_countermeasures) {
-		resp = WLAN_REASON_MICHAEL_MIC_FAILURE;
-		goto fail;
-	}
-#endif
-
 	pstat->capability = capab_info;
 
-#if 0//todo:
-	//check listen_interval
-	if (listen_interval > hapd->conf->max_listen_interval) {
-		hostapd_logger(hapd, mgmt->sa, HOSTAPD_MODULE_IEEE80211,
-			       HOSTAPD_LEVEL_DEBUG,
-			       "Too large Listen Interval (%d)",
-			       listen_interval);
-		resp = WLAN_STATUS_ASSOC_DENIED_LISTEN_INT_TOO_LARGE;
-		goto fail;
-	}
-
-	pstat->listen_interval = listen_interval;
-#endif
-
 	//now parse all ieee802_11 ie to point to elems
 	if (rtw_ieee802_11_parse_elems(pos, left, &elems, 1) == ParseFailed ||
 	    !elems.ssid) {
@@ -6773,16 +6650,6 @@ int _issue_probereq(_adapter *padapter,
 		pframe = rtw_set_ie(pframe, _SUPPORTEDRATES_IE_ , bssrate_len , bssrate, &(pattrib->pktlen));
 	}
 
-#if 0
-	//add wps_ie for wps2.0
-	if(pmlmepriv->probereq_wpsie_len>0 && pmlmepriv->probereq_wpsie_len<MAX_WPS_IE_LEN)
-	{
-		_rtw_memcpy(pframe, pmlmepriv->probereq_wpsie, pmlmepriv->probereq_wpsie_len);
-		pframe += pmlmepriv->probereq_wpsie_len;
-		pattrib->pktlen += pmlmepriv->probereq_wpsie_len;
-		//pmlmepriv->probereq_wpsie_len = 0 ;//reset to zero
-	}
-#else
 	//add wps_ie for wps2.0
 	if(pmlmepriv->wps_probe_req_ie_len>0 && pmlmepriv->wps_probe_req_ie)
 	{
@@ -6791,7 +6658,6 @@ int _issue_probereq(_adapter *padapter,
 		pattrib->pktlen += pmlmepriv->wps_probe_req_ie_len;
 		//pmlmepriv->wps_probe_req_ie_len = 0 ;//reset to zero
 	}
-#endif
 
 	pattrib->last_txcmdsz = pattrib->pktlen;
 
@@ -7317,9 +7183,6 @@ void issue_assocreq(_adapter *padapter)
 	DBG_871X("bssrate_len = %d\n", bssrate_len);
 
 #else	// Check if the AP's supported rates are also supported by STA.
-#if 0
-	get_rate_set(padapter, bssrate, &bssrate_len);
-#else
 	for (bssrate_len = 0; bssrate_len < NumRates; bssrate_len++) {
 		if (pmlmeinfo->network.SupportedRates[bssrate_len] == 0) break;
 
@@ -7328,7 +7191,6 @@ void issue_assocreq(_adapter *padapter)
 
 		bssrate[bssrate_len] = pmlmeinfo->network.SupportedRates[bssrate_len];
 	}
-#endif
 #endif	// Check if the AP's supported rates are also supported by STA.
 
 	if (bssrate_len == 0) {
@@ -9031,16 +8893,7 @@ u8 collect_bss_info(_adapter *padapter,
 	}
 
 	//todo:
-#if 0
-	if (judge_network_type(bssid->SupportedRates, (len + i)) == WIRELESS_11B)
-	{
-		bssid->NetworkTypeInUse = Ndis802_11DS;
-	}
-	else
-#endif
-	{
-		bssid->NetworkTypeInUse = Ndis802_11OFDM24;
-	}
+	bssid->NetworkTypeInUse = Ndis802_11OFDM24;
 
 	if (bssid->IELength < 12)
 		return _FAIL;
@@ -9608,22 +9461,6 @@ static void process_80211d(PADAPTER pada
 #endif
 #endif
 
-#if 0
-		// recover the right channel index
-		channel = chplan_sta[pmlmeext->sitesurvey_res.channel_idx].ChannelNum;
-		k = 0;
-		while ((k < MAX_CHANNEL_NUM) && (chplan_new[k].ChannelNum != 0))
-		{
-			if (chplan_new[k].ChannelNum == channel) {
-				RT_TRACE(_module_rtl871x_mlme_c_, _drv_notice_,
-						 ("%s: change mlme_ext sitesurvey channel index from %d to %d\n",
-						  __FUNCTION__, pmlmeext->sitesurvey_res.channel_idx, k));
-				pmlmeext->sitesurvey_res.channel_idx = k;
-				break;
-			}
-			k++;
-		}
-#endif
 	}
 
 	// If channel is used by AP, set channel scan type to active
@@ -9997,28 +9834,17 @@ void mlmeext_joinbss_event_callback(_ada
 	struct sta_priv		*pstapriv = &padapter->stapriv;
 	u8	join_type;
 
-	if(join_res < 0)
-	{
+	if(join_res < 0) {
 		join_type = 1;
 		rtw_hal_set_hwreg(padapter, HW_VAR_MLME_JOIN, (u8 *)(&join_type));
 		rtw_hal_set_hwreg(padapter, HW_VAR_BSSID, null_addr);
 
 		//restore to initial setting.
 		update_tx_basic_rate(padapter, padapter->registrypriv.wireless_mode);
-#if 0 //temply remove
-#ifdef CONFIG_INTEL_WIDI
-#ifdef DBG_CONFIG_ERROR_DETECT
-		DBG_871X("%s(): do silentreset\n",__FUNCTION__);
-		if(padapter->HalFunc.silentreset)
-			padapter->HalFunc.silentreset(padapter);
-#endif
-#endif
-#endif
 		goto exit_mlmeext_joinbss_event_callback;
 	}
 
-	if((pmlmeinfo->state&0x03) == WIFI_FW_ADHOC_STATE)
-	{
+	if((pmlmeinfo->state&0x03) == WIFI_FW_ADHOC_STATE) {
 		//for bc/mc
 		psta_bmc = rtw_get_bcmc_stainfo(padapter);
 		if(psta_bmc)
@@ -10608,73 +10434,6 @@ void link_timer_hdl(_adapter *padapter)
 		issue_assocreq(padapter);
 		set_link_timer(pmlmeext, REASSOC_TO);
 	}
-#if 0
-	else if (is_client_associated_to_ap(padapter))
-	{
-		//linked infrastructure client mode
-		if ((psta = rtw_get_stainfo(pstapriv, pmlmeinfo->network.MacAddress)) != NULL)
-		{
-			/*to monitor whether the AP is alive or not*/
-			if (rx_pkt == psta->sta_stats.rx_pkts)
-			{
-				receive_disconnect(padapter, pmlmeinfo->network.MacAddress);
-				return;
-			}
-			else
-			{
-				rx_pkt = psta->sta_stats.rx_pkts;
-				set_link_timer(pmlmeext, DISCONNECT_TO);
-			}
-
-			//update the EDCA paramter according to the Tx/RX mode
-			update_EDCA_param(padapter);
-
-			/*to send the AP a nulldata if no frame is xmitted in order to keep alive*/
-			if (pmlmeinfo->link_count++ == 0)
-			{
-				tx_cnt = pxmitpriv->tx_pkts;
-			}
-			else if ((pmlmeinfo->link_count & 0xf) == 0)
-			{
-				if (tx_cnt == pxmitpriv->tx_pkts)
-				{
-					issue_nulldata(padapter, NULL, 0, 0, 0);
-				}
-
-				tx_cnt = pxmitpriv->tx_pkts;
-			}
-		} //end of if ((psta = rtw_get_stainfo(pstapriv, passoc_res->network.MacAddress)) != NULL)
-	}
-	else if (is_client_associated_to_ibss(padapter))
-	{
-		//linked IBSS mode
-		//for each assoc list entry to check the rx pkt counter
-		for (i = IBSS_START_MAC_ID; i < NUM_STA; i++)
-		{
-			if (pmlmeinfo->FW_sta_info[i].status == 1)
-			{
-				psta = pmlmeinfo->FW_sta_info[i].psta;
-
-				if (pmlmeinfo->FW_sta_info[i].rx_pkt == psta->sta_stats.rx_pkts)
-				{
-					pmlmeinfo->FW_sta_info[i].status = 0;
-					report_del_sta_event(padapter, psta->hwaddr);
-				}
-				else
-				{
-					pmlmeinfo->FW_sta_info[i].rx_pkt = psta->sta_stats.rx_pkts;
-				}
-			}
-		}
-
-		set_link_timer(pmlmeext, DISCONNECT_TO);
-	}
-#endif
-
-#ifdef PLATFORM_FREEBSD
-	rtw_mtx_unlock(NULL);
-#endif
-
 	return;
 }
 
@@ -10936,37 +10695,7 @@ u8 join_cmd_hdl(_adapter *padapter, u8 *
 
 		i += (pIE->Length + 2);
 	}
-#if 0
-	if (padapter->registrypriv.wifi_spec) {
-		// for WiFi test, follow WMM test plan spec
-		acparm = 0x002F431C; // VO
-		rtw_hal_set_hwreg(padapter, HW_VAR_AC_PARAM_VO, (u8 *)(&acparm));
-		acparm = 0x005E541C; // VI
-		rtw_hal_set_hwreg(padapter, HW_VAR_AC_PARAM_VI, (u8 *)(&acparm));
-		acparm = 0x0000A525; // BE
-		rtw_hal_set_hwreg(padapter, HW_VAR_AC_PARAM_BE, (u8 *)(&acparm));
-		acparm = 0x0000A549; // BK
-		rtw_hal_set_hwreg(padapter, HW_VAR_AC_PARAM_BK, (u8 *)(&acparm));
-
-		// for WiFi test, mixed mode with intel STA under bg mode throughput issue
-		if (padapter->mlmepriv.htpriv.ht_option == _FALSE){
-			acparm = 0x00004320;
-			rtw_hal_set_hwreg(padapter, HW_VAR_AC_PARAM_BE, (u8 *)(&acparm));
-		}
-	}
-	else {
-		acparm = 0x002F3217; // VO
-		rtw_hal_set_hwreg(padapter, HW_VAR_AC_PARAM_VO, (u8 *)(&acparm));
-		acparm = 0x005E4317; // VI
-		rtw_hal_set_hwreg(padapter, HW_VAR_AC_PARAM_VI, (u8 *)(&acparm));
-		acparm = 0x00105320; // BE
-		rtw_hal_set_hwreg(padapter, HW_VAR_AC_PARAM_BE, (u8 *)(&acparm));
-		acparm = 0x0000A444; // BK
-		rtw_hal_set_hwreg(padapter, HW_VAR_AC_PARAM_BK, (u8 *)(&acparm));
-	}
-#endif
 	//disable dynamic functions, such as high power, DIG
-	//Switch_DM_Func(padapter, DYNAMIC_FUNC_DISABLE, _FALSE);
 
 	//config the initial gain under linking, need to write the BB registers
 
@@ -11201,11 +10930,6 @@ u8 sitesurvey_cmd_hdl(_adapter *padapter
 	if ((pmlmeext->sitesurvey_res.state == SCAN_START) || (pmlmeext->sitesurvey_res.state == SCAN_TXNULL))
 	{
 #ifdef CONFIG_FIND_BEST_CHANNEL
-#if 0
-		for (i=0; pmlmeext->channel_set[i].ChannelNum !=0; i++) {
-			pmlmeext->channel_set[i].rx_count = 0;
-		}
-#endif
 #endif /* CONFIG_FIND_BEST_CHANNEL */
 
 		//disable dynamic functions, such as high power, DIG
--- a/drivers/staging/rtl8192du/core/rtw_mp_ioctl.c
+++ b/drivers/staging/rtl8192du/core/rtw_mp_ioctl.c
@@ -880,50 +880,11 @@ _func_exit_;
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_pro8711_join_bss_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	PNDIS_802_11_SSID pssid;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	*poid_par_priv->bytes_needed = (u32)sizeof(NDIS_802_11_SSID);
-	*poid_par_priv->bytes_rw = 0;
-	if (poid_par_priv->information_buf_len < *poid_par_priv->bytes_needed)
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	pssid = (PNDIS_802_11_SSID)poid_par_priv->information_buf;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-
-	if (mp_start_joinbss(Adapter, pssid) == _FAIL)
-		status = NDIS_STATUS_NOT_ACCEPTED;
-
-	_irqlevel_changed_(&oldirql, RAISE);
-
-	*poid_par_priv->bytes_rw = sizeof(NDIS_802_11_SSID);
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_pro_read_register_hdl(struct oid_par_priv *poid_par_priv)
 {
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
 	pRW_Reg		RegRWStruct;
 	u32		offset, width;
 	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
@@ -1036,1235 +997,206 @@ _func_exit_;
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_pro_burst_read_register_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	pBurst_RW_Reg	pBstRwReg;
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-	PADAPTER	padapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_notice_, ("+oid_rt_pro_burst_read_register_hdl\n"));
-
-	if (poid_par_priv->type_of_oid != QUERY_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	pBstRwReg = (pBurst_RW_Reg)poid_par_priv->information_buf;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-	rtw_read_mem(padapter, pBstRwReg->offset, (u32)pBstRwReg->len, pBstRwReg->Data);
-	_irqlevel_changed_(&oldirql, RAISE);
-
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-
-	RT_TRACE(_module_mp_, _drv_info_, ("-oid_rt_pro_burst_read_register_hdl\n"));
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_pro_burst_write_register_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	pBurst_RW_Reg	pBstRwReg;
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-	PADAPTER	padapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_notice_, ("+oid_rt_pro_burst_write_register_hdl\n"));
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	pBstRwReg = (pBurst_RW_Reg)poid_par_priv->information_buf;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-	rtw_write_mem(padapter, pBstRwReg->offset, (u32)pBstRwReg->len, pBstRwReg->Data);
-	_irqlevel_changed_(&oldirql, RAISE);
-
-	RT_TRACE(_module_mp_, _drv_info_, ("-oid_rt_pro_burst_write_register_hdl\n"));
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_pro_write_txcmd_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	PADAPTER	Adapter = (PADAPTER)( poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-
-	TX_CMD_Desc	*TxCmd_Info;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	RT_TRACE(_module_mp_, _drv_info_, ("+Set OID_RT_PRO_WRITE_TXCMD\n"));
-
-	TxCmd_Info=(TX_CMD_Desc*)poid_par_priv->information_buf;
-
-	RT_TRACE(_module_mp_, _drv_info_, ("WRITE_TXCMD:Addr=%.8X\n", TxCmd_Info->offset));
-	RT_TRACE(_module_mp_, _drv_info_, ("WRITE_TXCMD:1.)%.8X\n", (ULONG)TxCmd_Info->TxCMD.value[0]));
-	RT_TRACE(_module_mp_, _drv_info_, ("WRITE_TXCMD:2.)%.8X\n", (ULONG)TxCmd_Info->TxCMD.value[1]));
-	RT_TRACE(_module_mp_, _drv_info_, (("WRITE_TXCMD:3.)%.8X\n", (ULONG)TxCmd_Info->TxCMD.value[2]));
-	RT_TRACE(_module_mp_, _drv_info_, ("WRITE_TXCMD:4.)%.8X\n", (ULONG)TxCmd_Info->TxCMD.value[3]));
-
-	_irqlevel_changed_(&oldirql, LOWER);
-
-	rtw_write32(Adapter, TxCmd_Info->offset + 0, (unsigned int)TxCmd_Info->TxCMD.value[0]);
-	rtw_write32(Adapter, TxCmd_Info->offset + 4, (unsigned int)TxCmd_Info->TxCMD.value[1]);
-
-	_irqlevel_changed_(&oldirql, RAISE);
-
-	RT_TRACE(_module_mp_, _drv_notice_,
-		 ("-Set OID_RT_PRO_WRITE_TXCMD: status=0x%08X\n", status));
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_pro_read16_eeprom_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	pEEPROM_RWParam pEEPROM;
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-	PADAPTER	padapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_info_, ("+Query OID_RT_PRO_READ16_EEPROM\n"));
-
-	if (poid_par_priv->type_of_oid != QUERY_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	pEEPROM = (pEEPROM_RWParam)poid_par_priv->information_buf;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-	pEEPROM->value = eeprom_read16(padapter, (u16)(pEEPROM->offset >> 1));
-	_irqlevel_changed_(&oldirql, RAISE);
-
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-
-	RT_TRACE(_module_mp_,  _drv_notice_,
-		 ("-Query OID_RT_PRO_READ16_EEPROM: offset=0x%x value=0x%x\n",
-		  pEEPROM->offset, pEEPROM->value));
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_pro_write16_eeprom_hdl (struct oid_par_priv *poid_par_priv)
 {
-#if 0
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	pEEPROM_RWParam pEEPROM;
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-	PADAPTER	padapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_notice_, ("+Set OID_RT_PRO_WRITE16_EEPROM\n"));
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	pEEPROM = (pEEPROM_RWParam)poid_par_priv->information_buf;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-	eeprom_write16(padapter, (u16)(pEEPROM->offset >> 1), pEEPROM->value);
-	_irqlevel_changed_(&oldirql, RAISE);
-
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_pro8711_wi_poll_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	PADAPTER	Adapter = (PADAPTER)( poid_par_priv->adapter_context);
-
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	struct mp_wiparam *pwi_param;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != QUERY_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (poid_par_priv->information_buf_len < sizeof(struct mp_wiparam))
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	if (Adapter->mppriv.workparam.bcompleted == _FALSE)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	pwi_param = (struct mp_wiparam *)poid_par_priv->information_buf;
-
-	_rtw_memcpy(pwi_param, &Adapter->mppriv.workparam, sizeof(struct mp_wiparam));
-	Adapter->mppriv.act_in_progress = _FALSE;
-//	RT_TRACE(_module_mp_, _drv_info_, ("rf:%x\n", pwiparam->IoValue));
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_pro8711_pkt_loss_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	PADAPTER	Adapter = (PADAPTER)( poid_par_priv->adapter_context);
-
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_notice_, ("+oid_rt_pro8711_pkt_loss_hdl\n"));
-
-	if (poid_par_priv->type_of_oid != QUERY_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (poid_par_priv->information_buf_len < sizeof(uint)*2) {
-		RT_TRACE(_module_mp_, _drv_err_, ("-oid_rt_pro8711_pkt_loss_hdl: buf_len=%d\n", (int)poid_par_priv->information_buf_len));
-		return NDIS_STATUS_INVALID_LENGTH;
-	}
-
-	if (*(uint*)poid_par_priv->information_buf == 1)//init==1
-		Adapter->mppriv.rx_pktloss = 0;
-
-	*((uint*)poid_par_priv->information_buf+1) = Adapter->mppriv.rx_pktloss;
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_rd_attrib_mem_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	PADAPTER	Adapter = (PADAPTER)( poid_par_priv->adapter_context);
-	struct io_queue *pio_queue = (struct io_queue *)Adapter->pio_queue;
-	struct intf_hdl	*pintfhdl = &pio_queue->intf;
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-#ifdef CONFIG_SDIO_HCI
-	void (*_attrib_read)(struct intf_hdl *pintfhdl, u32 addr, u32 cnt, u8 *pmem);
-#endif
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_notice_, ("+Query OID_RT_RD_ATTRIB_MEM\n"));
-
-	if (poid_par_priv->type_of_oid != QUERY_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-#ifdef CONFIG_SDIO_HCI
-	_irqlevel_changed_(&oldirql, LOWER);
-{
-	u32 *plmem = (u32*)poid_par_priv->information_buf+2;
-	_attrib_read = pintfhdl->io_ops._attrib_read;
-	_attrib_read(pintfhdl, *((u32*)poid_par_priv->information_buf),
-				*((u32*)poid_par_priv->information_buf+1), (u8*)plmem);
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-}
-	_irqlevel_changed_(&oldirql, RAISE);
-#endif
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_wr_attrib_mem_hdl (struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-	struct io_queue *pio_queue = (struct io_queue *)Adapter->pio_queue;
-	struct intf_hdl	*pintfhdl = &pio_queue->intf;
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-#ifdef CONFIG_SDIO_HCI
-	void (*_attrib_write)(struct intf_hdl *pintfhdl, u32 addr, u32 cnt, u8 *pmem);
-#endif
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-#ifdef CONFIG_SDIO_HCI
-	_irqlevel_changed_(&oldirql, LOWER);
+	return 0;
+}
+//------------------------------------------------------------------------------
+NDIS_STATUS  oid_rt_pro_set_rf_intfs_hdl(struct oid_par_priv *poid_par_priv)
 {
-	u32 *plmem = (u32*)poid_par_priv->information_buf + 2;
-	_attrib_write = pintfhdl->io_ops._attrib_write;
-	_attrib_write(pintfhdl, *(u32*)poid_par_priv->information_buf,
-				*((u32*)poid_par_priv->information_buf+1), (u8*)plmem);
+	return 0;
 }
-	_irqlevel_changed_(&oldirql, RAISE);
-#endif
-
-_func_exit_;
-
-	return status;
-#else
+//------------------------------------------------------------------------------
+NDIS_STATUS oid_rt_poll_rx_status_hdl(struct oid_par_priv *poid_par_priv)
+{
 	return 0;
-#endif
 }
 //------------------------------------------------------------------------------
-NDIS_STATUS  oid_rt_pro_set_rf_intfs_hdl(struct oid_par_priv *poid_par_priv)
+NDIS_STATUS oid_rt_pro_cfg_debug_message_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+//------------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_set_data_rate_ex_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
 	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
 
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
 	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
 
 _func_enter_;
 
-	RT_TRACE(_module_mp_, _drv_notice_, ("+OID_RT_PRO_SET_RF_INTFS\n"));
+	RT_TRACE(_module_mp_, _drv_notice_, ("+OID_RT_PRO_SET_DATA_RATE_EX\n"));
 
 	if (poid_par_priv->type_of_oid != SET_OID)
 		return NDIS_STATUS_NOT_ACCEPTED;
 
 	_irqlevel_changed_(&oldirql, LOWER);
 
-	if (rtw_setrfintfs_cmd(Adapter, *(unsigned char*)poid_par_priv->information_buf) == _FAIL)
+	if (rtw_setdatarate_cmd(Adapter, poid_par_priv->information_buf) !=_SUCCESS)
 		status = NDIS_STATUS_NOT_ACCEPTED;
 
-	_irqlevel_changed_(&oldirql, RAISE);
-
-_func_exit_;
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_poll_rx_status_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != QUERY_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	_rtw_memcpy(poid_par_priv->information_buf, (unsigned char*)&Adapter->mppriv.rxstat, sizeof(struct recv_stat));
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-
-_func_exit_;
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_cfg_debug_message_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	PCFG_DBG_MSG_STRUCT pdbg_msg;
-
-_func_enter_;
-
-//	RT_TRACE(0xffffffffff,_drv_alert_,("===> oid_rt_pro_cfg_debug_message_hdl.\n"));
-
-#if 0//#ifdef CONFIG_DEBUG_RTL871X
-
-	pdbg_msg = (PCFG_DBG_MSG_STRUCT)(poid_par_priv->information_buf);
-
-	if (poid_par_priv->type_of_oid == SET_OID) {
-		RT_TRACE(0xffffffffff, _drv_alert_,
-			 ("===>Set level :0x%08x, H32:0x%08x L32:0x%08x\n",
-			  pdbg_msg->DebugLevel, pdbg_msg->DebugComponent_H32, pdbg_msg->DebugComponent_L32));
-
-		GlobalDebugLevel = pdbg_msg->DebugLevel;
-		GlobalDebugComponents = (pdbg_msg->DebugComponent_H32 << 32) | pdbg_msg->DebugComponent_L32;
-		RT_TRACE(0xffffffffff, _drv_alert_,
-			 ("===> Set level :0x%08x, component:0x%016x\n",
-			  GlobalDebugLevel, (u32)GlobalDebugComponents));
-	} else {
-		pdbg_msg->DebugLevel = GlobalDebugLevel;
-		pdbg_msg->DebugComponent_H32 = (u32)(GlobalDebugComponents >> 32);
-		pdbg_msg->DebugComponent_L32 = (u32)GlobalDebugComponents;
-		*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-
-		RT_TRACE(0xffffffffff, _drv_alert_,
-			 ("===>Query level:0x%08x H32:0x%08x L32:0x%08x\n",
-			  (u32)pdbg_msg->DebugLevel, (u32)pdbg_msg->DebugComponent_H32, (u32)pdbg_msg->DebugComponent_L32));
-	}
-
-#endif
-
-_func_exit_;
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_set_data_rate_ex_hdl(struct oid_par_priv *poid_par_priv)
-{
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_notice_, ("+OID_RT_PRO_SET_DATA_RATE_EX\n"));
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-
-	if (rtw_setdatarate_cmd(Adapter, poid_par_priv->information_buf) !=_SUCCESS)
-		status = NDIS_STATUS_NOT_ACCEPTED;
-
-	_irqlevel_changed_(&oldirql, RAISE);
-
-_func_exit_;
-
-	return status;
-}
-//-----------------------------------------------------------------------------
-NDIS_STATUS oid_rt_get_thermal_meter_hdl(struct oid_par_priv *poid_par_priv)
-{
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-	u8 thermal = 0;
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_notice_, ("+oid_rt_get_thermal_meter_hdl\n"));
-
-	if (poid_par_priv->type_of_oid != QUERY_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (poid_par_priv->information_buf_len < sizeof(u32))
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-	GetThermalMeter(Adapter, &thermal);
-	_irqlevel_changed_(&oldirql, RAISE);
-
-	*(u32*)poid_par_priv->information_buf = (u32)thermal;
-	*poid_par_priv->bytes_rw = sizeof(u32);
-
-_func_exit_;
-
-	return status;
-}
-//-----------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_read_tssi_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_notice_, ("+oid_rt_pro_read_tssi_hdl\n"));
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (Adapter->mppriv.act_in_progress == _TRUE)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (poid_par_priv->information_buf_len < sizeof(u8))
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	//init workparam
-	Adapter->mppriv.act_in_progress = _TRUE;
-	Adapter->mppriv.workparam.bcompleted = _FALSE;
-	Adapter->mppriv.workparam.act_type = MPT_READ_TSSI;
-	Adapter->mppriv.workparam.io_offset = 0;
-	Adapter->mppriv.workparam.io_value = 0xFFFFFFFF;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-
-	if (!rtw_gettssi_cmd(Adapter,0, (u8*)&Adapter->mppriv.workparam.io_value))
-		status = NDIS_STATUS_NOT_ACCEPTED;
-
-	_irqlevel_changed_(&oldirql, RAISE);
-
-_func_exit_;
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_set_power_tracking_hdl(struct oid_par_priv *poid_par_priv)
-{
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-
-_func_enter_;
-
-//	if (poid_par_priv->type_of_oid != SET_OID)
-//		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (poid_par_priv->information_buf_len < sizeof(u8))
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-	if (poid_par_priv->type_of_oid == SET_OID) {
-		u8 enable;
-
-		enable = *(u8*)poid_par_priv->information_buf;
-		RT_TRACE(_module_mp_, _drv_notice_,
-			 ("+oid_rt_pro_set_power_tracking_hdl: enable=%d\n", enable));
-
-		SetPowerTracking(Adapter, enable);
-	} else {
-		GetPowerTracking(Adapter, (u8*)poid_par_priv->information_buf);
-	}
-	_irqlevel_changed_(&oldirql, RAISE);
-
-_func_exit_;
-
-	return status;
-}
-//-----------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_set_basic_rate_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	u32 ratevalue;
-	u8 datarates[NumRates];
-	int i;
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-	PADAPTER	padapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_info_, ("+OID_RT_PRO_SET_BASIC_RATE\n"));
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-#if 0
-	ratevalue = *((u32*)poid_par_priv->information_buf);
-
-	for (i = 0; i < NumRates; i++) {
-		if (ratevalue == mpdatarate[i])
-			datarates[i] = mpdatarate[i];
-		else
-			datarates[i] = 0xff;
-		RT_TRACE(_module_rtl871x_ioctl_c_, _drv_info_, ("basicrate_inx=%d\n", datarates[i]));
-	}
-
-	_irqlevel_changed_(&oldirql, LOWER);
-
-	if (rtw_setbasicrate_cmd(padapter, datarates) != _SUCCESS)
-		status = NDIS_STATUS_NOT_ACCEPTED;
-
-	_irqlevel_changed_(&oldirql, RAISE);
-#endif
-	RT_TRACE(_module_mp_, _drv_notice_,
-		 ("-OID_RT_PRO_SET_BASIC_RATE: status=0x%08X\n", status));
-
-_func_exit_;
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_qry_pwrstate_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != QUERY_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (poid_par_priv->information_buf_len < 8)
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	*poid_par_priv->bytes_rw = 8;
-	_rtw_memcpy(poid_par_priv->information_buf, &(Adapter->pwrctrlpriv.pwr_mode), 8);
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-
-	RT_TRACE(_module_mp_, _drv_notice_,
-		 ("-oid_rt_pro_qry_pwrstate_hdl: pwr_mode=%d smart_ps=%d\n",
-		  Adapter->pwrctrlpriv.pwr_mode, Adapter->pwrctrlpriv.smart_ps));
-
-_func_exit_;
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_set_pwrstate_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	uint pwr_mode, smart_ps;
-
-_func_enter_;
-
-	RT_TRACE(_module_mp_, _drv_notice_, ("+Set OID_RT_PRO_SET_PWRSTATE\n"));
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	*poid_par_priv->bytes_rw = 0;
-	*poid_par_priv->bytes_needed = 8;
-
-	if (poid_par_priv->information_buf_len < 8)
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	pwr_mode = *(uint *)(poid_par_priv->information_buf);
-	smart_ps = *(uint *)((int)poid_par_priv->information_buf + 4);
-
-	*poid_par_priv->bytes_rw = 8;
-
-_func_exit_;
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_h2c_set_rate_table_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	struct setratable_parm *prate_table;
-	u8		res;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	*poid_par_priv->bytes_needed  = sizeof(struct setratable_parm);
-	if (poid_par_priv->information_buf_len < sizeof(struct setratable_parm))
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	prate_table = (struct setratable_parm*)poid_par_priv->information_buf;
-
-	_irqlevel_changed_(&oldirql, LOWER);
-	res = rtw_setrttbl_cmd(Adapter, prate_table);
-	_irqlevel_changed_(&oldirql, RAISE);
-
-	if (res == _FAIL)
-		status = NDIS_STATUS_FAILURE;
-
-_func_exit_;
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_h2c_get_rate_table_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != QUERY_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	#if 0
-			struct mp_wi_cntx *pmp_wi_cntx=&(Adapter->mppriv.wi_cntx);
-			u8 res=_SUCCESS;
-			DEBUG_INFO(("===> Set OID_RT_PRO_H2C_GET_RATE_TABLE.\n"));
-
-			if(pmp_wi_cntx->bmp_wi_progress ==_TRUE){
-				DEBUG_ERR(("\n mp workitem is progressing, not allow to set another workitem right now!!!\n"));
-				Status = NDIS_STATUS_NOT_ACCEPTED;
-				break;
-			}
-			else{
-				pmp_wi_cntx->bmp_wi_progress=_TRUE;
-				pmp_wi_cntx->param.bcompleted=_FALSE;
-				pmp_wi_cntx->param.act_type=MPT_GET_RATE_TABLE;
-				pmp_wi_cntx->param.io_offset=0x0;
-				pmp_wi_cntx->param.bytes_cnt=sizeof(struct getratable_rsp);
-				pmp_wi_cntx->param.io_value=0xffffffff;
-
-				res=rtw_getrttbl_cmd(Adapter,(struct getratable_rsp *)pmp_wi_cntx->param.data);
-				*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-				if(res != _SUCCESS)
-				{
-					Status = NDIS_STATUS_NOT_ACCEPTED;
-				}
-			}
-			DEBUG_INFO(("\n <=== Set OID_RT_PRO_H2C_GET_RATE_TABLE.\n"));
-	#endif
-
-_func_exit_;
-
-	return status;
-#else
-	return 0;
-#endif
-}
-
-//****************  oid_rtl_seg_87_12_00   section start ****************
-NDIS_STATUS oid_rt_pro_encryption_ctrl_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-	struct security_priv *psecuritypriv = &Adapter->securitypriv;
-
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	ENCRY_CTRL_STATE encry_mode;
-
-
-	*poid_par_priv->bytes_needed = sizeof(u8);
-	if (poid_par_priv->information_buf_len < *poid_par_priv->bytes_needed)
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	if (poid_par_priv->type_of_oid == SET_OID)
-	{
-		encry_mode = *((u8*)poid_par_priv->information_buf);
-		switch (encry_mode)
-		{
-			case HW_CONTROL:
-				#if 0
-				Adapter->registrypriv.software_decrypt=_FALSE;
-				Adapter->registrypriv.software_encrypt=_FALSE;
-				#else
-				psecuritypriv->sw_decrypt = _FALSE;
-				psecuritypriv->sw_encrypt = _FALSE;
-				#endif
-				break;
-			case SW_CONTROL:
-				#if 0
-				Adapter->registrypriv.software_decrypt=_TRUE;
-				Adapter->registrypriv.software_encrypt=_TRUE;
-				#else
-				psecuritypriv->sw_decrypt = _TRUE;
-				psecuritypriv->sw_encrypt = _TRUE;
-				#endif
-				break;
-			case HW_ENCRY_SW_DECRY:
-				#if 0
-				Adapter->registrypriv.software_decrypt=_TRUE;
-				Adapter->registrypriv.software_encrypt=_FALSE;
-				#else
-				psecuritypriv->sw_decrypt = _TRUE;
-				psecuritypriv->sw_encrypt = _FALSE;
-				#endif
-				break;
-			case SW_ENCRY_HW_DECRY:
-				#if 0
-				Adapter->registrypriv.software_decrypt=_FALSE;
-				Adapter->registrypriv.software_encrypt=_TRUE;
-				#else
-				psecuritypriv->sw_decrypt = _FALSE;
-				psecuritypriv->sw_encrypt = _TRUE;
-				#endif
-				break;
-		}
-
-		RT_TRACE(_module_rtl871x_ioctl_c_, _drv_notice_,
-			 ("-oid_rt_pro_encryption_ctrl_hdl: SET encry_mode=0x%x sw_encrypt=0x%x sw_decrypt=0x%x\n",
-			  encry_mode, psecuritypriv->sw_encrypt, psecuritypriv->sw_decrypt));
-	}
-	else {
-		#if 0
-		if (Adapter->registrypriv.software_encrypt == _FALSE) {
-			if (Adapter->registrypriv.software_decrypt == _FALSE)
-				encry_mode = HW_CONTROL;
-			else
-				encry_mode = HW_ENCRY_SW_DECRY;
-		}
-		else {
-			if (Adapter->registrypriv.software_decrypt == _FALSE)
-				encry_mode = SW_ENCRY_HW_DECRY;
-			else
-				encry_mode = SW_CONTROL;
-		}
-		#else
-
-		if ((psecuritypriv->sw_encrypt == _FALSE) && (psecuritypriv->sw_decrypt == _FALSE))
-			encry_mode = HW_CONTROL;
-		else if ((psecuritypriv->sw_encrypt == _FALSE) && (psecuritypriv->sw_decrypt == _TRUE))
-			encry_mode = HW_ENCRY_SW_DECRY;
-		else if ((psecuritypriv->sw_encrypt == _TRUE) && (psecuritypriv->sw_decrypt == _FALSE))
-			encry_mode = SW_ENCRY_HW_DECRY;
-		else if ((psecuritypriv->sw_encrypt == _TRUE) && (psecuritypriv->sw_decrypt == _TRUE))
-			encry_mode = SW_CONTROL;
-
-		#endif
-
-		*(u8*)poid_par_priv->information_buf =  encry_mode;
-		*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-
-		RT_TRACE(_module_mp_, _drv_notice_,
-			 ("-oid_rt_pro_encryption_ctrl_hdl: QUERY encry_mode=0x%x\n",
-			  encry_mode));
-	}
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_add_sta_info_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	struct sta_info *psta = NULL;
-	UCHAR		*macaddr;
-
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	*poid_par_priv->bytes_needed = ETH_ALEN;
-	if (poid_par_priv->information_buf_len < *poid_par_priv->bytes_needed)
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	macaddr = (UCHAR *) poid_par_priv->information_buf ;
-
-	RT_TRACE(_module_rtl871x_ioctl_c_,_drv_notice_,
-		 ("OID_RT_PRO_ADD_STA_INFO: addr="MAC_FMT"\n", MAC_ARG(macaddr) ));
-
-	_irqlevel_changed_(&oldirql, LOWER);
-
-	psta = rtw_get_stainfo(&Adapter->stapriv, macaddr);
-
-	if (psta == NULL) { // the sta have been in sta_info_queue => do nothing
-		psta = rtw_alloc_stainfo(&Adapter->stapriv, macaddr);
-
-		if (psta == NULL) {
-			RT_TRACE(_module_rtl871x_ioctl_c_,_drv_err_,("Can't alloc sta_info when OID_RT_PRO_ADD_STA_INFO\n"));
-			status = NDIS_STATUS_FAILURE;
-		}
-	} else { //(between drv has received this event before and  fw have not yet to set key to CAM_ENTRY)
-		RT_TRACE(_module_rtl871x_ioctl_c_, _drv_err_,
-			("Error: OID_RT_PRO_ADD_STA_INFO: sta has been in sta_hash_queue \n"));
-	}
-
-	_irqlevel_changed_(&oldirql, RAISE);
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_dele_sta_info_hdl(struct oid_par_priv *poid_par_priv)
-{
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	struct sta_info *psta = NULL;
-	UCHAR		*macaddr;
-
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	*poid_par_priv->bytes_needed = ETH_ALEN;
-	if (poid_par_priv->information_buf_len < *poid_par_priv->bytes_needed)
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	macaddr = (UCHAR *) poid_par_priv->information_buf ;
-	RT_TRACE(_module_rtl871x_ioctl_c_,_drv_notice_,
-		 ("+OID_RT_PRO_ADD_STA_INFO: addr="MAC_FMT"\n", MAC_ARG(macaddr) ));
-
-	psta = rtw_get_stainfo(&Adapter->stapriv, macaddr);
-	if (psta != NULL) {
-		_enter_critical(&(Adapter->stapriv.sta_hash_lock), &irqL);
-		rtw_free_stainfo(Adapter, psta);
-		_exit_critical(&(Adapter->stapriv.sta_hash_lock), &irqL);
-	}
-
-	return status;
-#else
-	return 0;
-#endif
-}
-//------------------------------------------------------------------------------
-#if 0
-#include <sdio_osintf.h>
-static u32 mp_query_drv_var(_adapter *padapter, u8 offset, u32 var)
-{
-#ifdef CONFIG_SDIO_HCI
-
-	if (offset == 1) {
-		u16 tmp_blk_num;
-		tmp_blk_num = rtw_read16(padapter, SDIO_RX0_RDYBLK_NUM);
-		RT_TRACE(_module_mp_, _drv_err_, ("Query Information, mp_query_drv_var  SDIO_RX0_RDYBLK_NUM=0x%x   adapter_to_dvobj(padapter)->rxblknum=0x%x\n", tmp_blk_num, adapter_to_dvobj(padapter)->rxblknum));
-		if (adapter_to_dvobj(padapter)->rxblknum != tmp_blk_num) {
-			RT_TRACE(_module_mp_,_drv_err_, ("Query Information, mp_query_drv_var  call recv rx\n"));
-		//	sd_recv_rxfifo(padapter);
-		}
-	}
-
-#if 0
-	if(offset <=100){  //For setting data rate and query data rate
-		if(offset==100){ //For query data rate
-			RT_TRACE(_module_mp_, _drv_emerg_, ("\n mp_query_drv_var: offset(%d): query rate=0x%.2x \n",offset,padapter->registrypriv.tx_rate));
-			var=padapter->registrypriv.tx_rate;
-
-		}
-		else if(offset<0x1d){  //For setting data rate
-			padapter->registrypriv.tx_rate=offset;
-			var=padapter->registrypriv.tx_rate;
-			padapter->registrypriv.use_rate=_TRUE;
-			RT_TRACE(_module_mp_, _drv_emerg_, ("\n mp_query_drv_var: offset(%d): set rate=0x%.2x \n",offset,padapter->registrypriv.tx_rate));
-		}
-		else{ //not use the data rate
-			padapter->registrypriv.use_rate=_FALSE;
-			RT_TRACE(_module_mp_, _drv_emerg_, ("\n mp_query_drv_var: offset(%d) out of rate range\n",offset));
-		}
-	}
-	else if (offset<=110){  //for setting debug level
-		RT_TRACE(_module_mp_, _drv_emerg_, (" mp_query_drv_var: offset(%d) for set debug level\n",offset));
-		if(offset==110){ //For query data rate
-			RT_TRACE(_module_mp_, _drv_emerg_, (" mp_query_drv_var: offset(%d): query dbg level=0x%.2x \n",offset,padapter->registrypriv.dbg_level));
-			padapter->registrypriv.dbg_level=GlobalDebugLevel;
-			var=padapter->registrypriv.dbg_level;
-		}
-		else if(offset<110 && offset>100){
-			RT_TRACE(_module_mp_, _drv_emerg_, (" mp_query_drv_var: offset(%d): set dbg level=0x%.2x \n",offset,offset-100));
-			padapter->registrypriv.dbg_level=GlobalDebugLevel=offset-100;
-			var=padapter->registrypriv.dbg_level;
-			RT_TRACE(_module_mp_, _drv_emerg_, (" mp_query_drv_var(_drv_emerg_): offset(%d): set dbg level=0x%.2x \n",offset,GlobalDebugLevel));
-			RT_TRACE(_module_mp_, _drv_alert_, (" mp_query_drv_var(_drv_alert_): offset(%d): set dbg level=0x%.2x \n",offset,GlobalDebugLevel));
-			RT_TRACE(_module_mp_, _drv_crit_, (" mp_query_drv_var(_drv_crit_): offset(%d): set dbg level=0x%.2x \n",offset,GlobalDebugLevel));
-			RT_TRACE(_module_mp_, _drv_err_, (" mp_query_drv_var(_drv_err_): offset(%d): set dbg level=0x%.2x \n",offset,GlobalDebugLevel));
-			RT_TRACE(_module_mp_, _drv_warning_, (" mp_query_drv_var(_drv_warning_): offset(%d): set dbg level=0x%.2x \n",offset,GlobalDebugLevel));
-			RT_TRACE(_module_mp_, _drv_notice_, (" mp_query_drv_var(_drv_notice_): offset(%d): set dbg level=0x%.2x \n",offset,GlobalDebugLevel));
-			RT_TRACE(_module_mp_, _drv_info_, (" mp_query_drv_var(_drv_info_): offset(%d): set dbg level=0x%.2x \n",offset,GlobalDebugLevel));
-			RT_TRACE(_module_mp_, _drv_debug_, (" mp_query_drv_var(_drv_debug_): offset(%d): set dbg level=0x%.2x \n",offset,GlobalDebugLevel));
-
-		}
-	}
-	else if(offset >110 &&offset <116){
-		if(115==offset){
-			RT_TRACE(_module_mp_, _drv_emerg_, (" mp_query_drv_var(_drv_emerg_): offset(%d): query TRX access type: [tx_block_mode=%x,rx_block_mode=%x]\n",\
-															offset, adapter_to_dvobj(padapter)->tx_block_mode, adapter_to_dvobj(padapter)->rx_block_mode));
-		}
-		else {
-			switch(offset){
-				case 111:
-					adapter_to_dvobj(padapter)->tx_block_mode=1;
-					adapter_to_dvobj(padapter)->rx_block_mode=1;
-					RT_TRACE(_module_mp_, _drv_emerg_, \
-						(" mp_query_drv_var(_drv_emerg_): offset(%d): SET TRX access type:(TX block/RX block) [tx_block_mode=%x,rx_block_mode=%x]\n",\
-						offset, adapter_to_dvobj(padapter)->tx_block_mode, adapter_to_dvobj(padapter)->rx_block_mode));
-					break;
-				case 112:
-					adapter_to_dvobj(padapter)->tx_block_mode=1;
-					adapter_to_dvobj(padapter)->rx_block_mode=0;
-					RT_TRACE(_module_mp_, _drv_emerg_, \
-						(" mp_query_drv_var(_drv_emerg_): offset(%d): SET TRX access type:(TX block/RX byte) [tx_block_mode=%x,rx_block_mode=%x]\n",\
-						offset, adapter_to_dvobj(padapter)->tx_block_mode, adapter_to_dvobj(padapter)->rx_block_mode));
-					break;
-				case 113:
-					adapter_to_dvobj(padapter)->tx_block_mode=0;
-					adapter_to_dvobj(padapter)->rx_block_mode=1;
-					RT_TRACE(_module_mp_, _drv_emerg_, \
-						(" mp_query_drv_var(_drv_emerg_): offset(%d): SET TRX access type:(TX byte/RX block) [tx_block_mode=%x,rx_block_mode=%x]\n",\
-						offset, adapter_to_dvobj(padapter)->tx_block_mode, adapter_to_dvobj(padapter)->rx_block_mode));
-					break;
-				case 114:
-					adapter_to_dvobj(padapter)->tx_block_mode=0;
-					adapter_to_dvobj(padapter)->rx_block_mode=0;
-					RT_TRACE(_module_mp_, _drv_emerg_, \
-						(" mp_query_drv_var(_drv_emerg_): offset(%d): SET TRX access type:(TX byte/RX byte) [tx_block_mode=%x,rx_block_mode=%x]\n",\
-						offset, adapter_to_dvobj(padapter)->tx_block_mode, adapter_to_dvobj(padapter)->rx_block_mode));
-					break;
-				default :
-					break;
-
-			}
-
-		}
-
-	}
-	else if(offset>=127){
-		u64	prnt_dbg_comp;
-		u8   chg_idx;
-		u64	tmp_dbg_comp;
-		chg_idx=offset-0x80;
-		tmp_dbg_comp=BIT(chg_idx);
-		prnt_dbg_comp=padapter->registrypriv.dbg_component= GlobalDebugComponents;
-		RT_TRACE(_module_mp_, _drv_emerg_, (" 1: mp_query_drv_var: offset(%d;0x%x):for dbg conpoment prnt_dbg_comp=0x%.16x GlobalDebugComponents=0x%.16x padapter->registrypriv.dbg_component=0x%.16x\n",offset,offset,prnt_dbg_comp,GlobalDebugComponents,padapter->registrypriv.dbg_component));
-		if(offset==127){
-	//		prnt_dbg_comp=padapter->registrypriv.dbg_component= GlobalDebugComponents;
-			var=(u32)(padapter->registrypriv.dbg_component);
-			RT_TRACE(0xffffffff, _drv_emerg_, ("2: mp_query_drv_var: offset(%d;0x%x):for query dbg conpoment=0x%x(l) 0x%x(h)  GlobalDebugComponents=0x%x(l) 0x%x(h) \n",offset,offset,padapter->registrypriv.dbg_component,prnt_dbg_comp));
-			prnt_dbg_comp=GlobalDebugComponents;
-			RT_TRACE(0xffffffff, _drv_emerg_, ("2-1: mp_query_drv_var: offset(%d;0x%x):for query dbg conpoment=0x%x(l) 0x%x(h)  GlobalDebugComponents=0x%x(l) 0x%x(h)\n",offset,offset,padapter->registrypriv.dbg_component,prnt_dbg_comp));
-			prnt_dbg_comp=GlobalDebugComponents=padapter->registrypriv.dbg_component;
-			RT_TRACE(0xffffffff, _drv_emerg_, ("2-2: mp_query_drv_var: offset(%d;0x%x):for query dbg conpoment=0x%x(l) 0x%x(h)  GlobalDebugComponents=0x%x(l) 0x%x(h)\n",offset,offset,padapter->registrypriv.dbg_component,prnt_dbg_comp));
-
-		}
-		else{
-			RT_TRACE(0xffffffff, _drv_emerg_, ("3: mp_query_drv_var: offset(%d;0x%x):for query dbg conpoment=0x%x(l) 0x%x(h) GlobalDebugComponents=0x%x(l) 0x%x(h) chg_idx=%d\n",offset,offset,padapter->registrypriv.dbg_component,prnt_dbg_comp,chg_idx));
-			prnt_dbg_comp=GlobalDebugComponents;
-			RT_TRACE(0xffffffff, _drv_emerg_,("3-1: mp_query_drv_var: offset(%d;0x%x):for query dbg conpoment=0x%x(l) 0x%x(h)  GlobalDebugComponents=0x%x(l) 0x%x(h) chg_idx=%d\n",offset,offset,padapter->registrypriv.dbg_component,prnt_dbg_comp,chg_idx));// ("3-1: mp_query_drv_var: offset(%d;0x%x):before set dbg conpoment=0x%x chg_idx=%d or0x%x BIT(chg_idx[%d]=0x%x)\n",offset,offset,prnt_dbg_comp,chg_idx,chg_idx,(chg_idx),tmp_dbg_comp)
-			prnt_dbg_comp=GlobalDebugComponents=padapter->registrypriv.dbg_component;
-			RT_TRACE(0xffffffff, _drv_emerg_, ("3-2: mp_query_drv_var: offset(%d;0x%x):for query dbg conpoment=0x%x(l) 0x%x(h)  GlobalDebugComponents=0x%x(l) 0x%x(h)\n",offset,offset,padapter->registrypriv.dbg_component,prnt_dbg_comp));
-
-			if(GlobalDebugComponents&tmp_dbg_comp){
-				//this bit is already set, now clear it
-				GlobalDebugComponents=GlobalDebugComponents&(~tmp_dbg_comp);
-			}
-			else{
-				//this bit is not set, now set it.
-				GlobalDebugComponents =GlobalDebugComponents|tmp_dbg_comp;
-			}
-			RT_TRACE(0xffffffff, _drv_emerg_, ("4: mp_query_drv_var: offset(%d;0x%x):before set dbg conpoment tmp_dbg_comp=0x%x GlobalDebugComponents=0x%x(l) 0x%x(h)",offset,offset,tmp_dbg_comp,prnt_dbg_comp));
-			prnt_dbg_comp=GlobalDebugComponents;
-			RT_TRACE(0xffffffff, _drv_emerg_, ("4-1: mp_query_drv_var: offset(%d;0x%x):before set dbg conpoment tmp_dbg_comp=0x%x GlobalDebugComponents=0x%x(l) 0x%x(h)",offset,offset,tmp_dbg_comp,prnt_dbg_comp));
-
-			RT_TRACE(_module_rtl871x_xmit_c_, _drv_emerg_, ("0: mp_query_drv_var(_module_rtl871x_xmit_c_:0): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,prnt_dbg_comp));
-			RT_TRACE(_module_xmit_osdep_c_, _drv_emerg_, ("1: mp_query_drv_var(_module_xmit_osdep_c_:1): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_recv_c_, _drv_emerg_, ("2: mp_query_drv_var(_module_rtl871x_recv_c_:2): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_recv_osdep_c_, _drv_emerg_, ("3: mp_query_drv_var(_module_recv_osdep_c_:3): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_mlme_c_, _drv_emerg_, ("4: mp_query_drv_var(_module_rtl871x_mlme_c_:4): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_mlme_osdep_c_, _drv_emerg_, (" 5:mp_query_drv_var(_module_mlme_osdep_c_:5): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_sta_mgt_c_, _drv_emerg_, ("6: mp_query_drv_var(_module_rtl871x_sta_mgt_c_:6): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_cmd_c_, _drv_emerg_, ("7: mp_query_drv_var(_module_rtl871x_cmd_c_:7): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_cmd_osdep_c_, _drv_emerg_, ("8: mp_query_drv_var(_module_cmd_osdep_c_:8): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_io_c_, _drv_emerg_, ("9: mp_query_drv_var(_module_rtl871x_io_c_:9): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_io_osdep_c_, _drv_emerg_, ("10: mp_query_drv_var(_module_io_osdep_c_:10): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_os_intfs_c_, _drv_emerg_, ("11: mp_query_drv_var(_module_os_intfs_c_:11): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_security_c_, _drv_emerg_, ("12: mp_query_drv_var(_module_rtl871x_security_c_:12): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_eeprom_c_, _drv_emerg_, ("13: mp_query_drv_var(_module_rtl871x_eeprom_c_:13): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_hal_init_c_, _drv_emerg_, ("14: mp_query_drv_var(_module_hal_init_c_:14): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_hci_hal_init_c_, _drv_emerg_, ("15: mp_query_drv_var(_module_hci_hal_init_c_:15): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_ioctl_c_, _drv_emerg_, ("16: mp_query_drv_var(_module_rtl871x_ioctl_c_:16): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_ioctl_set_c_, _drv_emerg_, ("17: mp_query_drv_var(_module_rtl871x_ioctl_set_c_:17): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_ioctl_query_c_, _drv_emerg_, ("18: mp_query_drv_var(_module_rtl871x_ioctl_query_c_:18): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_rtl871x_pwrctrl_c_, _drv_emerg_, ("19: mp_query_drv_var(_module_rtl871x_pwrctrl_c_:19): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_hci_intfs_c_, _drv_emerg_, ("20: mp_query_drv_var(_module_hci_intfs_c_:20): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_hci_ops_c_, _drv_emerg_, ("21: mp_query_drv_var(_module_hci_ops_c_:21): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_osdep_service_c_, _drv_emerg_, ("22: mp_query_drv_var(_module_osdep_service_c_:22): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_mp_, _drv_emerg_, ("23: mp_query_drv_var(_module_mp_:23): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			RT_TRACE(_module_hci_ops_os_c_, _drv_emerg_, ("24: mp_query_drv_var(_module_hci_ops_os_c_:24): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
-			var=(u32)(GlobalDebugComponents);
-			//GlobalDebugComponents=padapter->registrypriv.dbg_component;
-			RT_TRACE(0xffffffff, _drv_emerg_, (" ==mp_query_drv_var(_module_mp_): offset(%d;0x%x):before set dbg conpoment=0x%x(l) 0x%x(h)\n",offset,offset,GlobalDebugComponents));
+	_irqlevel_changed_(&oldirql, RAISE);
 
-		}
-	}
-	else{
-		RT_TRACE(_module_mp_, _drv_emerg_, ("\n mp_query_drv_var: offset(%d) >110\n",offset));
-	}
-#endif
-#endif
+_func_exit_;
 
-	return var;
+	return status;
 }
-#endif
-
-NDIS_STATUS oid_rt_pro_query_dr_variable_hdl(struct oid_par_priv *poid_par_priv)
+//-----------------------------------------------------------------------------
+NDIS_STATUS oid_rt_get_thermal_meter_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	PADAPTER		Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL			oldirql;
-#endif
-	NDIS_STATUS		status = NDIS_STATUS_SUCCESS;
+	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
+	u8 thermal = 0;
+	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
 
-	DR_VARIABLE_STRUCT	*pdrv_var;
+_func_enter_;
 
+	RT_TRACE(_module_mp_, _drv_notice_, ("+oid_rt_get_thermal_meter_hdl\n"));
 
 	if (poid_par_priv->type_of_oid != QUERY_OID)
 		return NDIS_STATUS_NOT_ACCEPTED;
 
-	*poid_par_priv->bytes_needed = sizeof(DR_VARIABLE_STRUCT);
-	if (poid_par_priv->information_buf_len < *poid_par_priv->bytes_needed)
+	if (poid_par_priv->information_buf_len < sizeof(u32))
 		return NDIS_STATUS_INVALID_LENGTH;
 
-	RT_TRACE(_module_mp_, _drv_notice_, ("+Query Information, OID_RT_PRO_QUERY_DR_VARIABLE\n"));
-
-	pdrv_var = (struct _DR_VARIABLE_STRUCT_ *)poid_par_priv->information_buf;
-
 	_irqlevel_changed_(&oldirql, LOWER);
-	pdrv_var->variable = mp_query_drv_var(Adapter, pdrv_var->offset, pdrv_var->variable);
+	GetThermalMeter(Adapter, &thermal);
 	_irqlevel_changed_(&oldirql, RAISE);
 
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
+	*(u32*)poid_par_priv->information_buf = (u32)thermal;
+	*poid_par_priv->bytes_rw = sizeof(u32);
 
-	RT_TRACE(_module_mp_, _drv_notice_,
-		 ("-oid_rt_pro_query_dr_variable_hdl: offset=0x%x valule=0x%x\n",
-		  pdrv_var->offset, pdrv_var->variable));
+_func_exit_;
 
 	return status;
-#else
+}
+//-----------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_read_tssi_hdl(struct oid_par_priv *poid_par_priv)
+{
 	return 0;
-#endif
 }
 //------------------------------------------------------------------------------
-NDIS_STATUS oid_rt_pro_rx_packet_type_hdl(struct oid_par_priv *poid_par_priv)
+NDIS_STATUS oid_rt_pro_set_power_tracking_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
+#ifdef PLATFORM_OS_XP
+	_irqL		oldirql;
+#endif
+	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
 	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
 
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
 
-	RT_TRACE(_module_mp_, _drv_err_, ("oid_rt_pro_rx_packet_type_hdl...................\n"));
+_func_enter_;
 
-	if (poid_par_priv->information_buf_len < sizeof (UCHAR)) {
-		status = NDIS_STATUS_INVALID_LENGTH;
-		*poid_par_priv->bytes_needed = sizeof(UCHAR);
-		return status;
-	}
+	if (poid_par_priv->information_buf_len < sizeof(u8))
+		return NDIS_STATUS_INVALID_LENGTH;
 
+	_irqlevel_changed_(&oldirql, LOWER);
 	if (poid_par_priv->type_of_oid == SET_OID) {
-		Adapter->mppriv.rx_with_status = *(UCHAR *) poid_par_priv->information_buf;
-		RT_TRACE(_module_rtl871x_ioctl_c_,_drv_err_, ("Query Information, OID_RT_PRO_RX_PACKET_TYPE:%d \n",\
-												Adapter->mppriv.rx_with_status));
-
-		//*(u32 *)&Adapter->eeprompriv.mac_addr[0]=rtw_read32(Adapter, 0x10250050);
-		//*(u16 *)&Adapter->eeprompriv.mac_addr[4]=rtw_read16(Adapter, 0x10250054);
-		RT_TRACE(_module_rtl871x_ioctl_c_,_drv_err_,("MAC addr=0x%x:0x%x:0x%x:0x%x:0x%x:0x%x  \n",
-			Adapter->eeprompriv.mac_addr[0],Adapter->eeprompriv.mac_addr[1],Adapter->eeprompriv.mac_addr[2],\
-			Adapter->eeprompriv.mac_addr[3],Adapter->eeprompriv.mac_addr[4],Adapter->eeprompriv.mac_addr[5]));
+		u8 enable;
+
+		enable = *(u8*)poid_par_priv->information_buf;
+		RT_TRACE(_module_mp_, _drv_notice_,
+			 ("+oid_rt_pro_set_power_tracking_hdl: enable=%d\n", enable));
 
+		SetPowerTracking(Adapter, enable);
+	} else {
+		GetPowerTracking(Adapter, (u8*)poid_par_priv->information_buf);
 	}
-	else {
-		*(UCHAR *) poid_par_priv->information_buf = Adapter->mppriv.rx_with_status;
-		*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
+	_irqlevel_changed_(&oldirql, RAISE);
 
-		RT_TRACE(_module_rtl871x_ioctl_c_,_drv_err_, ("Query Information, OID_RT_PRO_RX_PACKET_TYPE:%d \n", \
-												Adapter->mppriv.rx_with_status));
+_func_exit_;
 
-		//*(u32 *)&Adapter->eeprompriv.mac_addr[0]=rtw_read32(Adapter, 0x10250050);
-		//*(u16 *)&Adapter->eeprompriv.mac_addr[4]=rtw_read16(Adapter, 0x10250054);
-		RT_TRACE(_module_rtl871x_ioctl_c_,_drv_err_,("MAC addr=0x%x:0x%x:0x%x:0x%x:0x%x:0x%x  \n",
-			Adapter->eeprompriv.mac_addr[0],Adapter->eeprompriv.mac_addr[1],Adapter->eeprompriv.mac_addr[2],\
-			Adapter->eeprompriv.mac_addr[3],Adapter->eeprompriv.mac_addr[4],Adapter->eeprompriv.mac_addr[5]));
-	}
-#endif
+	return status;
+}
+//-----------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_set_basic_rate_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+//------------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_qry_pwrstate_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+//------------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_set_pwrstate_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+//------------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_h2c_set_rate_table_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+//------------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_h2c_get_rate_table_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+
+//****************  oid_rtl_seg_87_12_00   section start ****************
+NDIS_STATUS oid_rt_pro_encryption_ctrl_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+//------------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_add_sta_info_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+//------------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_dele_sta_info_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+//------------------------------------------------------------------------------
 
+NDIS_STATUS oid_rt_pro_query_dr_variable_hdl(struct oid_par_priv *poid_par_priv)
+{
+	return 0;
+}
+//------------------------------------------------------------------------------
+NDIS_STATUS oid_rt_pro_rx_packet_type_hdl(struct oid_par_priv *poid_par_priv)
+{
 	return NDIS_STATUS_SUCCESS;
 }
 //------------------------------------------------------------------------------
@@ -2557,36 +1489,6 @@ _func_exit_;
 NDIS_STATUS oid_rt_set_crystal_cap_hdl(struct oid_par_priv *poid_par_priv)
 {
 	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-
-	u32		crystal_cap = 0;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (poid_par_priv->information_buf_len <sizeof(u32))
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	crystal_cap = *((u32*)poid_par_priv->information_buf);//4
-	if (crystal_cap > 0xf)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	Adapter->mppriv.curr_crystalcap = crystal_cap;
-
-	_irqlevel_changed_(&oldirql,LOWER);
-	SetCrystalCap(Adapter);
-	_irqlevel_changed_(&oldirql,RAISE);
-
-_func_exit_;
-
-#endif
 	return status;
 }
 
@@ -2613,71 +1515,6 @@ _func_enter_;
 	rx_pkt_type = *((u8*)poid_par_priv->information_buf);//4
 
 	RT_TRACE(_module_mp_, _drv_info_, ("rx_pkt_type: %x\n",rx_pkt_type ));
-#if 0
-	_irqlevel_changed_(&oldirql, LOWER);
-#if 0
-	rcr_val8 = rtw_read8(Adapter, 0x10250048);//RCR
-	rcr_val8 &= ~(RCR_AB|RCR_AM|RCR_APM|RCR_AAP);
-
-	if(rx_pkt_type == RX_PKT_BROADCAST){
-		rcr_val8 |= (RCR_AB | RCR_ACRC32 );
-	}
-	else if(rx_pkt_type == RX_PKT_DEST_ADDR){
-		rcr_val8 |= (RCR_AAP| RCR_AM |RCR_ACRC32);
-	}
-	else if(rx_pkt_type == RX_PKT_PHY_MATCH){
-		rcr_val8 |= (RCR_APM|RCR_ACRC32);
-	}
-	else{
-		rcr_val8 &= ~(RCR_AAP|RCR_APM|RCR_AM|RCR_AB|RCR_ACRC32);
-	}
-	rtw_write8(padapter, 0x10250048,rcr_val8);
-#else
-	rcr_val32 = rtw_read32(padapter, RCR);//RCR = 0x10250048
-	rcr_val32 &= ~(RCR_CBSSID|RCR_AB|RCR_AM|RCR_APM|RCR_AAP);
-#if 0
-	if(rx_pkt_type == RX_PKT_BROADCAST){
-		rcr_val32 |= (RCR_AB|RCR_AM|RCR_APM|RCR_AAP|RCR_ACRC32);
-	}
-	else if(rx_pkt_type == RX_PKT_DEST_ADDR){
-		//rcr_val32 |= (RCR_CBSSID|RCR_AAP|RCR_AM|RCR_ACRC32);
-		rcr_val32 |= (RCR_CBSSID|RCR_APM|RCR_ACRC32);
-	}
-	else if(rx_pkt_type == RX_PKT_PHY_MATCH){
-		rcr_val32 |= (RCR_APM|RCR_ACRC32);
-		//rcr_val32 |= (RCR_AAP|RCR_ACRC32);
-	}
-	else{
-		rcr_val32 &= ~(RCR_AAP|RCR_APM|RCR_AM|RCR_AB|RCR_ACRC32);
-	}
-#else
-	switch (rx_pkt_type)
-	{
-		case RX_PKT_BROADCAST :
-			rcr_val32 |= (RCR_AB|RCR_AM|RCR_APM|RCR_AAP|RCR_ACRC32);
-			break;
-		case RX_PKT_DEST_ADDR :
-			rcr_val32 |= (RCR_AB|RCR_AM|RCR_APM|RCR_AAP|RCR_ACRC32);
-			break;
-		case RX_PKT_PHY_MATCH:
-			rcr_val32 |= (RCR_APM|RCR_ACRC32);
-			break;
-		default:
-			rcr_val32 &= ~(RCR_AAP|RCR_APM|RCR_AM|RCR_AB|RCR_ACRC32);
-			break;
-	}
-
-	if (rx_pkt_type == RX_PKT_DEST_ADDR) {
-		padapter->mppriv.check_mp_pkt = 1;
-	} else {
-		padapter->mppriv.check_mp_pkt = 0;
-	}
-#endif
-	rtw_write32(padapter, RCR, rcr_val32);
-
-#endif
-	_irqlevel_changed_(&oldirql, RAISE);
-#endif
 _func_exit_;
 
 	return status;
@@ -2685,78 +1522,12 @@ _func_exit_;
 
 NDIS_STATUS oid_rt_pro_set_tx_agc_offset_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-
-	u32		txagc;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (poid_par_priv->information_buf_len < sizeof(u32))
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	txagc = *(u32*)poid_par_priv->information_buf;
-	RT_TRACE(_module_mp_, _drv_info_,
-		 ("oid_rt_pro_set_tx_agc_offset_hdl: 0x%08x\n", txagc));
-
-	_irqlevel_changed_(&oldirql, LOWER);
-	SetTxAGCOffset(Adapter, txagc);
-	_irqlevel_changed_(&oldirql, RAISE);
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 
 NDIS_STATUS oid_rt_pro_set_pkt_test_mode_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	PADAPTER		Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-
-	NDIS_STATUS		status = NDIS_STATUS_SUCCESS;
-
-	struct mlme_priv	*pmlmepriv = &Adapter->mlmepriv;
-	struct mp_priv		*pmppriv = &Adapter->mppriv;
-	u32			type;
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != SET_OID)
-		return NDIS_STATUS_NOT_ACCEPTED;
-
-	if (poid_par_priv->information_buf_len <sizeof(u32))
-		return NDIS_STATUS_INVALID_LENGTH;
-
-	type = *(u32*)poid_par_priv->information_buf;
-
-	if (_LOOPBOOK_MODE_ == type) {
-		pmppriv->mode = type;
-		set_fwstate(pmlmepriv, WIFI_MP_LPBK_STATE); //append txdesc
-		RT_TRACE(_module_mp_, _drv_info_, ("test mode change to loopback mode:0x%08x.\n", get_fwstate(pmlmepriv)));
-	} else if (_2MAC_MODE_ == type){
-		pmppriv->mode = type;
-		_clr_fwstate_(pmlmepriv, WIFI_MP_LPBK_STATE);
-		RT_TRACE(_module_mp_, _drv_info_, ("test mode change to 2mac mode:0x%08x.\n", get_fwstate(pmlmepriv)));
-	} else
-		status = NDIS_STATUS_NOT_ACCEPTED;
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
 
 unsigned int mp_ioctl_xmit_packet_hdl(struct oid_par_priv *poid_par_priv)
@@ -2793,99 +1564,11 @@ unsigned int mp_ioctl_xmit_packet_hdl(st
 	return NDIS_STATUS_SUCCESS;
 }
 
-#if 0
-unsigned int mp_ioctl_xmit_packet_hdl(struct oid_par_priv *poid_par_priv)
-{
-	unsigned char *pframe, *pmp_pkt;
-	struct ethhdr *pethhdr;
-	struct pkt_attrib *pattrib;
-	struct rtw_ieee80211_hdr *pwlanhdr;
-	unsigned short *fctrl;
-	int llc_sz, payload_len;
-	struct mp_xmit_frame *pxframe=  NULL;
-	struct mp_xmit_packet *pmp_xmitpkt = (struct mp_xmit_packet*)param;
-	u8 addr3[] = {0x02, 0xE0, 0x4C, 0x87, 0x66, 0x55};
-
-//	DBG_871X("+mp_ioctl_xmit_packet_hdl\n");
-
-	pxframe = alloc_mp_xmitframe(&padapter->mppriv);
-	if (pxframe == NULL)
-	{
-		DEBUG_ERR(("Can't alloc pmpframe %d:%s\n", __LINE__, __FILE__));
-		return -1;
-	}
-
-	//mp_xmit_pkt
-	payload_len = pmp_xmitpkt->len - 14;
-	pmp_pkt = (unsigned char*)pmp_xmitpkt->mem;
-	pethhdr = (struct ethhdr *)pmp_pkt;
-
-	//DBG_871X("payload_len=%d, pkt_mem=0x%x\n", pmp_xmitpkt->len, (void*)pmp_xmitpkt->mem);
-
-	//DBG_871X("pxframe=0x%x\n", (void*)pxframe);
-	//DBG_871X("pxframe->mem=0x%x\n", (void*)pxframe->mem);
-
-	//update attribute
-	pattrib = &pxframe->attrib;
-	memset((u8 *)(pattrib), 0, sizeof (struct pkt_attrib));
-	pattrib->pktlen = pmp_xmitpkt->len;
-	pattrib->ether_type = ntohs(pethhdr->h_proto);
-	pattrib->hdrlen = 24;
-	pattrib->nr_frags = 1;
-	pattrib->priority = 0;
-#ifndef CONFIG_MP_LINUX
-	if(IS_MCAST(pethhdr->h_dest))
-		pattrib->mac_id = 4;
-	else
-		pattrib->mac_id = 5;
-#else
-	pattrib->mac_id = 5;
-#endif
-
-	//
-	memset(pxframe->mem, 0 , WLANHDR_OFFSET);
-	pframe = (u8 *)(pxframe->mem) + WLANHDR_OFFSET;
-
-	pwlanhdr = (struct rtw_ieee80211_hdr *)pframe;
-
-	fctrl = &(pwlanhdr->frame_ctl);
-	*(fctrl) = 0;
-	SetFrameSubType(pframe, WIFI_DATA);
-
-	_rtw_memcpy(pwlanhdr->addr1, pethhdr->h_dest, ETH_ALEN);
-	_rtw_memcpy(pwlanhdr->addr2, pethhdr->h_source, ETH_ALEN);
-
-	_rtw_memcpy(pwlanhdr->addr3, addr3, ETH_ALEN);
-
-	pwlanhdr->seq_ctl = 0;
-	pframe += pattrib->hdrlen;
-
-	llc_sz= rtw_put_snap(pframe, pattrib->ether_type);
-	pframe += llc_sz;
-
-	_rtw_memcpy(pframe, (void*)(pmp_pkt+14),  payload_len);
-
-	pattrib->last_txcmdsz = pattrib->hdrlen + llc_sz + payload_len;
-
-	DEBUG_INFO(("issuing mp_xmit_frame, tx_len=%d, ether_type=0x%x\n", pattrib->last_txcmdsz, pattrib->ether_type));
-	xmit_mp_frame(padapter, pxframe);
-
-	return _SUCCESS;
-}
-#endif
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_set_power_down_hdl(struct oid_par_priv *poid_par_priv)
 {
-#ifdef PLATFORM_OS_XP
-	_irqL		oldirql;
-#endif
 	u8		bpwrup;
 	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-#ifdef PLATFORM_LINUX
-#ifdef CONFIG_SDIO_HCI
-	PADAPTER	padapter = (PADAPTER)(poid_par_priv->adapter_context);
-#endif
-#endif
 
 _func_enter_;
 
@@ -2900,16 +1583,8 @@ _func_enter_;
 	_irqlevel_changed_(&oldirql, LOWER);
 
 	bpwrup = *(u8 *)poid_par_priv->information_buf;
-	//CALL  the power_down function
-#ifdef PLATFORM_LINUX
-#ifdef CONFIG_SDIO_HCI
-	dev_power_down(padapter,bpwrup);
-#endif
-#endif
 	_irqlevel_changed_(&oldirql, RAISE);
 
-	//DEBUG_ERR(("\n <=== Query OID_RT_PRO_READ_REGISTER.
-	//	Add:0x%08x Width:%d Value:0x%08x\n",RegRWStruct->offset,RegRWStruct->width,RegRWStruct->value));
 
 _func_exit_;
 
@@ -2918,36 +1593,5 @@ _func_exit_;
 //------------------------------------------------------------------------------
 NDIS_STATUS oid_rt_get_power_mode_hdl(struct oid_par_priv *poid_par_priv)
 {
-#if 0
-	NDIS_STATUS	status = NDIS_STATUS_SUCCESS;
-	PADAPTER	Adapter = (PADAPTER)(poid_par_priv->adapter_context);
-//#ifdef PLATFORM_OS_XP
-//	_irqL		oldirql;
-//#endif
-
-_func_enter_;
-
-	if (poid_par_priv->type_of_oid != QUERY_OID) {
-		status = NDIS_STATUS_NOT_ACCEPTED;
-		return status;
-	}
-	if (poid_par_priv->information_buf_len < sizeof(u32)) {
-		status = NDIS_STATUS_INVALID_LENGTH;
-		return status;
-	}
-
-	RT_TRACE(_module_mp_, _drv_info_,
-		 ("\n ===> oid_rt_get_power_mode_hdl.\n"));
-
-//	_irqlevel_changed_(&oldirql, LOWER);
-	*(int*)poid_par_priv->information_buf = Adapter->registrypriv.low_power ? POWER_LOW : POWER_NORMAL;
-	*poid_par_priv->bytes_rw = poid_par_priv->information_buf_len;
-//	_irqlevel_changed_(&oldirql, RAISE);
-
-_func_exit_;
-
-	return status;
-#else
 	return 0;
-#endif
 }
--- a/drivers/staging/rtl8192du/core/rtw_p2p.c
+++ b/drivers/staging/rtl8192du/core/rtw_p2p.c
@@ -371,20 +371,6 @@ static void issue_p2p_provision_resp(str
 	RTW_PUT_BE32(wpsie, WPSOUI);
 	wpsielen += 4;
 
-#if 0
-	//	WPS version
-	//	Type:
-	*(u16*) ( wpsie + wpsielen ) = cpu_to_be16( WPS_ATTR_VER1 );
-	wpsielen += 2;
-
-	//	Length:
-	*(u16*) ( wpsie + wpsielen ) = cpu_to_be16( 0x0001 );
-	wpsielen += 2;
-
-	//	Value:
-	wpsie[wpsielen++] = WPS_VERSION_1;	//	Version 1.0
-#endif
-
 	//	Config Method
 	//	Type:
 	//*(u16*) ( wpsie + wpsielen ) = cpu_to_be16( WPS_ATTR_CONF_METHOD );
@@ -4712,21 +4698,7 @@ void dbg_rtw_p2p_set_pre_state(struct wi
 		);
 	}
 }
-#if 0
-void dbg_rtw_p2p_restore_state(struct wifidirect_info *wdinfo, const char *caller, int line)
-{
-	if(wdinfo->pre_p2p_state != -1) {
-		DBG_871X("[CONFIG_DBG_P2P]%s:%d restore from %s to %s\n", caller, line
-			, p2p_state_str[wdinfo->p2p_state], p2p_state_str[wdinfo->pre_p2p_state]
-		);
-		_rtw_p2p_restore_state(wdinfo);
-	} else {
-		DBG_871X("[CONFIG_DBG_P2P]%s:%d restore no pre state, cur state %s\n", caller, line
-			, p2p_state_str[wdinfo->p2p_state]
-		);
-	}
-}
-#endif
+
 void dbg_rtw_p2p_set_role(struct wifidirect_info *wdinfo, enum P2P_ROLE role, const char *caller, int line)
 {
 	if(wdinfo->role != role) {
--- a/drivers/staging/rtl8192du/core/rtw_pwrctrl.c
+++ b/drivers/staging/rtl8192du/core/rtw_pwrctrl.c
@@ -740,16 +740,6 @@ void cpwm_int_hdl(
 _func_enter_;
 
 	pwrpriv = &padapter->pwrctrlpriv;
-#if 0
-	if (pwrpriv->cpwm_tog == (preportpwrstate->state & PS_TOGGLE)) {
-		RT_TRACE(_module_rtl871x_pwrctrl_c_, _drv_err_,
-				 ("cpwm_int_hdl: tog(old)=0x%02x cpwm(new)=0x%02x toggle bit didn't change!?\n",
-				  pwrpriv->cpwm_tog, preportpwrstate->state));
-		goto exit;
-	}
-#endif
-//	_enter_pwrlock(&pwrpriv->lock);
-
 	pwrpriv->cpwm = PS_STATE(preportpwrstate->state);
 	pwrpriv->cpwm_tog = preportpwrstate->state & PS_TOGGLE;
 
@@ -761,8 +751,6 @@ _func_enter_;
 			_rtw_up_sema(&padapter->xmitpriv.xmit_sema);
 	}
 
-//	_exit_pwrlock(&pwrpriv->lock);
-
 exit:
 	RT_TRACE(_module_rtl871x_pwrctrl_c_, _drv_notice_,
 			 ("cpwm_int_hdl: cpwm=0x%02x\n", pwrpriv->cpwm));
--- a/drivers/staging/rtl8192du/core/rtw_wlan_util.c
+++ b/drivers/staging/rtl8192du/core/rtw_wlan_util.c
@@ -405,22 +405,6 @@ void Switch_DM_Func(_adapter *padapter,
 #endif
 		rtw_hal_set_hwreg(padapter, HW_VAR_DM_FUNC_CLR, (u8 *)(&mode));
 	}
-
-#if 0
-	u8 val8;
-
-	val8 = rtw_read8(padapter, FW_DYNAMIC_FUN_SWITCH);
-
-	if(enable == _TRUE)
-	{
-		rtw_write8(padapter, FW_DYNAMIC_FUN_SWITCH, (val8 | mode));
-	}
-	else
-	{
-		rtw_write8(padapter, FW_DYNAMIC_FUN_SWITCH, (val8 & mode));
-	}
-#endif
-
 }
 
 static void Set_NETYPE1_MSR(_adapter *padapter, u8 type)
@@ -695,35 +679,6 @@ void invalidate_cam_all(_adapter *padapt
 {
 	rtw_hal_set_hwreg(padapter, HW_VAR_CAM_INVALID_ALL, 0);
 }
-#if 0
-static u32 _ReadCAM(_adapter *padapter ,u32 addr)
-{
-	u32 count = 0, cmd;
-	cmd = CAM_POLLINIG |addr ;
-	rtw_write32(padapter, RWCAM, cmd);
-
-	do{
-		if(0 == (rtw_read32(padapter,REG_CAMCMD) & CAM_POLLINIG)){
-			break;
-		}
-	}while(count++ < 100);
-
-	return rtw_read32(padapter,REG_CAMREAD);
-}
-void read_cam(_adapter *padapter ,u8 entry)
-{
-	u32	j,count = 0, addr, cmd;
-	addr = entry << 3;
-
-	printk("********* DUMP CAM Entry_#%02d***************\n",entry);
-	for (j = 0; j < 6; j++)
-	{
-		cmd = _ReadCAM(padapter ,addr+j);
-		printk("offset:0x%02x => 0x%08x \n",addr+j,cmd);
-	}
-	printk("*********************************\n");
-}
-#endif
 
 void write_cam(_adapter *padapter, u8 entry, u16 ctrl, u8 *mac, u8 *key)
 {
@@ -771,33 +726,10 @@ void write_cam(_adapter *padapter, u8 en
 
 void clear_cam_entry(_adapter *padapter, u8 entry)
 {
-#if 0
-	u32	addr, val=0;
-	u32	cam_val[2];
-
-	addr = entry << 3;
-
-
-	cam_val[0] = val;
-	cam_val[1] = addr + (unsigned int)0;
-
-	rtw_hal_set_hwreg(padapter, HW_VAR_CAM_WRITE, (u8 *)cam_val);
-
-
-
-	cam_val[0] = val;
-	cam_val[1] = addr + (unsigned int)1;
-
-	rtw_hal_set_hwreg(padapter, HW_VAR_CAM_WRITE, (u8 *)cam_val);
-#else
-
 	unsigned char null_sta[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
-
 	unsigned char null_key[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00};
 
 	write_cam(padapter, entry, 0, null_sta, null_key);
-
-#endif
 }
 
 int allocate_fw_sta_entry(_adapter *padapter)
@@ -1267,56 +1199,6 @@ void HTOnAssocRsp(_adapter *padapter)
 
 	rtw_hal_set_hwreg(padapter, HW_VAR_AMPDU_FACTOR, (u8 *)(&max_AMPDU_len));
 
-#if 0 //move to rtw_update_ht_cap()
-	if ((pregpriv->cbw40_enable) &&
-		(pmlmeinfo->HT_caps.u.HT_cap_element.HT_caps_info & BIT(1)) &&
-		(pmlmeinfo->HT_info.infos[0] & BIT(2)))
-	{
-		//switch to the 40M Hz mode accoring to the AP
-		pmlmeext->cur_bwmode = HT_CHANNEL_WIDTH_40;
-		switch ((pmlmeinfo->HT_info.infos[0] & 0x3))
-		{
-			case HT_EXTCHNL_OFFSET_UPPER:
-				pmlmeext->cur_ch_offset = HAL_PRIME_CHNL_OFFSET_LOWER;
-				break;
-
-			case HT_EXTCHNL_OFFSET_LOWER:
-				pmlmeext->cur_ch_offset = HAL_PRIME_CHNL_OFFSET_UPPER;
-				break;
-
-			default:
-				pmlmeext->cur_ch_offset = HAL_PRIME_CHNL_OFFSET_DONT_CARE;
-				break;
-		}
-
-		//SelectChannel(padapter, pmlmeext->cur_channel, pmlmeext->cur_ch_offset);
-	}
-#endif
-
-	//set_channel_bwmode(padapter, pmlmeext->cur_channel, pmlmeext->cur_ch_offset, pmlmeext->cur_bwmode);
-
-#if 0 //move to rtw_update_ht_cap()
-	//
-	// Config SM Power Save setting
-	//
-	pmlmeinfo->SM_PS = (pmlmeinfo->HT_caps.u.HT_cap_element.HT_caps_info & 0x0C) >> 2;
-	if(pmlmeinfo->SM_PS == WLAN_HT_CAP_SM_PS_STATIC)
-	{
-		/*u8 i;
-		//update the MCS rates
-		for (i = 0; i < 16; i++)
-		{
-			pmlmeinfo->HT_caps.HT_cap_element.MCS_rate[i] &= MCS_rate_1R[i];
-		}*/
-		DBG_871X("%s(): WLAN_HT_CAP_SM_PS_STATIC\n",__FUNCTION__);
-	}
-
-	//
-	// Config current HT Protection mode.
-	//
-	pmlmeinfo->HT_protection = pmlmeinfo->HT_info.infos[1] & 0x3;
-#endif
-
 }
 
 void ERP_IE_handler(_adapter *padapter, PNDIS_802_11_VARIABLE_IEs pIE)
@@ -1412,40 +1294,25 @@ void update_beacon_info(_adapter *padapt
 
 	len = pkt_len - (_BEACON_IE_OFFSET_ + WLAN_HDR_A3_LEN);
 
-	for (i = 0; i < len;)
-	{
+	for (i = 0; i < len;) {
 		pIE = (PNDIS_802_11_VARIABLE_IEs)(pframe + (_BEACON_IE_OFFSET_ + WLAN_HDR_A3_LEN) + i);
 
-		switch (pIE->ElementID)
-		{
-#if 0
-			case _VENDOR_SPECIFIC_IE_:
-				//todo: to update WMM paramter set while receiving beacon
-				if (_rtw_memcmp(pIE->data, WMM_PARA_OUI, 6))	//WMM
-				{
-					(WMM_param_handler(padapter, pIE))? WMMOnAssocRsp(padapter): 0;
-				}
-				break;
-#endif
-
-			case _HT_EXTRA_INFO_IE_:	//HT info
-				//HT_info_handler(padapter, pIE);
-				bwmode_update_check(padapter, pIE);
-				break;
-
-			case _ERPINFO_IE_:
-				ERP_IE_handler(padapter, pIE);
-				VCS_update(padapter, psta);
-				break;
-
+		switch (pIE->ElementID) {
+		case _HT_EXTRA_INFO_IE_:	//HT info
+			bwmode_update_check(padapter, pIE);
+			break;
+		case _ERPINFO_IE_:
+			ERP_IE_handler(padapter, pIE);
+			VCS_update(padapter, psta);
+			break;
 #ifdef CONFIG_TDLS
-			case _EXT_CAP_IE_:
-				if( check_ap_tdls_prohibited(pIE->data, pIE->Length) == _TRUE )
-					ptdlsinfo->ap_prohibited = _TRUE;
-				break;
+		case _EXT_CAP_IE_:
+			if( check_ap_tdls_prohibited(pIE->data, pIE->Length) == _TRUE )
+				ptdlsinfo->ap_prohibited = _TRUE;
+			break;
 #endif //CONFIG_TDLS
-			default:
-				break;
+		default:
+			break;
 		}
 
 		i += (pIE->Length + 2);
@@ -1997,29 +1864,6 @@ void update_wireless_mode(_adapter *pada
 void fire_write_MAC_cmd(_adapter *padapter, unsigned int addr, unsigned int value);
 void fire_write_MAC_cmd(_adapter *padapter, unsigned int addr, unsigned int value)
 {
-#if 0
-	struct cmd_obj					*ph2c;
-	struct reg_rw_parm			*pwriteMacPara;
-	struct cmd_priv					*pcmdpriv = &(padapter->cmdpriv);
-
-	if ((ph2c = (struct cmd_obj*)rtw_zmalloc(sizeof(struct cmd_obj))) == NULL)
-	{
-		return;
-	}
-
-	if ((pwriteMacPara = (struct reg_rw_parm*)rtw_malloc(sizeof(struct reg_rw_parm))) == NULL)
-	{
-		rtw_mfree((unsigned char *)ph2c, sizeof(struct cmd_obj));
-		return;
-	}
-
-	pwriteMacPara->rw = 1;
-	pwriteMacPara->addr = addr;
-	pwriteMacPara->value = value;
-
-	init_h2fwcmd_w_parm_no_rsp(ph2c, pwriteMacPara, GEN_CMD_CODE(_Write_MACREG));
-	rtw_enqueue_cmd(pcmdpriv, ph2c);
-#endif
 }
 
 void update_bmc_sta_support_rate(_adapter *padapter, u32 mac_id)
@@ -2126,108 +1970,6 @@ void beacon_timing_control(_adapter *pad
 	rtw_hal_bcn_related_reg_setting(padapter);
 }
 
-#if 0
-unsigned int setup_beacon_frame(_adapter *padapter, unsigned char *beacon_frame)
-{
-	unsigned short				ATIMWindow;
-	unsigned char					*pframe;
-	struct tx_desc				*ptxdesc;
-	struct rtw_ieee80211_hdr	*pwlanhdr;
-	unsigned short				*fctrl;
-	unsigned int					rate_len, len = 0;
-	struct xmit_priv			*pxmitpriv = &(padapter->xmitpriv);
-	struct mlme_ext_priv	*pmlmeext = &(padapter->mlmeextpriv);
-	struct mlme_ext_info	*pmlmeinfo = &(pmlmeext->mlmext_info);
-	WLAN_BSSID_EX		*cur_network = &(pmlmeinfo->network);
-	u8	bc_addr[] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
-
-	_rtw_memset(beacon_frame, 0, 256);
-
-	pframe = beacon_frame + TXDESC_SIZE;
-
-	pwlanhdr = (struct rtw_ieee80211_hdr *)pframe;
-
-	fctrl = &(pwlanhdr->frame_ctl);
-	*(fctrl) = 0;
-
-	_rtw_memcpy(pwlanhdr->addr1, bc_addr, ETH_ALEN);
-	_rtw_memcpy(pwlanhdr->addr2, myid(&(padapter->eeprompriv)), ETH_ALEN);
-	_rtw_memcpy(pwlanhdr->addr3, get_my_bssid(cur_network), ETH_ALEN);
-
-	SetFrameSubType(pframe, WIFI_BEACON);
-
-	pframe += sizeof(struct rtw_ieee80211_hdr_3addr);
-	len = sizeof(struct rtw_ieee80211_hdr_3addr);
-
-	//timestamp will be inserted by hardware
-	pframe += 8;
-	len += 8;
-
-	// beacon interval: 2 bytes
-	_rtw_memcpy(pframe, (unsigned char *)(rtw_get_beacon_interval_from_ie(cur_network->IEs)), 2);
-
-	pframe += 2;
-	len += 2;
-
-	// capability info: 2 bytes
-	_rtw_memcpy(pframe, (unsigned char *)(rtw_get_capability_from_ie(cur_network->IEs)), 2);
-
-	pframe += 2;
-	len += 2;
-
-	// SSID
-	pframe = rtw_set_ie(pframe, _SSID_IE_, cur_network->Ssid.SsidLength, cur_network->Ssid.Ssid, &len);
-
-	// supported rates...
-	rate_len = rtw_get_rateset_len(cur_network->SupportedRates);
-	pframe = rtw_set_ie(pframe, _SUPPORTEDRATES_IE_, ((rate_len > 8)? 8: rate_len), cur_network->SupportedRates, &len);
-
-	// DS parameter set
-	pframe = rtw_set_ie(pframe, _DSSET_IE_, 1, (unsigned char *)&(cur_network->Configuration.DSConfig), &len);
-
-	// IBSS Parameter Set...
-	//ATIMWindow = cur->Configuration.ATIMWindow;
-	ATIMWindow = 0;
-	pframe = rtw_set_ie(pframe, _IBSS_PARA_IE_, 2, (unsigned char *)(&ATIMWindow), &len);
-
-	//todo: ERP IE
-
-	// EXTERNDED SUPPORTED RATE
-	if (rate_len > 8)
-	{
-		pframe = rtw_set_ie(pframe, _EXT_SUPPORTEDRATES_IE_, (rate_len - 8), (cur_network->SupportedRates + 8), &len);
-	}
-
-	if ((len + TXDESC_SIZE) > 256)
-	{
-		//DBG_871X("marc: beacon frame too large\n");
-		return 0;
-	}
-
-	//fill the tx descriptor
-	ptxdesc = (struct tx_desc *)beacon_frame;
-
-	//offset 0
-	ptxdesc->txdw0 |= cpu_to_le32(len & 0x0000ffff);
-	ptxdesc->txdw0 |= cpu_to_le32(((TXDESC_SIZE + OFFSET_SZ) << OFFSET_SHT) & 0x00ff0000); //default = 32 bytes for TX Desc
-
-	//offset 4
-	ptxdesc->txdw1 |= cpu_to_le32((0x10 << QSEL_SHT) & 0x00001f00);
-
-	//offset 8
-	ptxdesc->txdw2 |= cpu_to_le32(BMC);
-	ptxdesc->txdw2 |= cpu_to_le32(BK);
-
-	//offset 16
-	ptxdesc->txdw4 = 0x80000000;
-
-	//offset 20
-	ptxdesc->txdw5 = 0x00000000; //1M
-
-	return (len + TXDESC_SIZE);
-}
-#endif
-
 static _adapter *pbuddy_padapter = NULL;
 
 int rtw_handle_dualmac(_adapter *adapter, bool init)
--- a/drivers/staging/rtl8192du/hal/usb_halinit.c
+++ b/drivers/staging/rtl8192du/hal/usb_halinit.c
@@ -2638,106 +2638,49 @@ _ResetDigitalProcedure1(
 
 	HAL_DATA_TYPE *pHalData = GET_HAL_DATA(Adapter);
 
-	//if((pHalData->FirmwareVersion <=  0x20)&&(_FALSE)){
-	if(0){
-		#if 0
-		/*****************************
-		f.	SYS_FUNC_EN 0x03[7:0]=0x54		// reset MAC register, DCORE
-		g.	MCUFWDL 0x80[7:0]=0				// reset MCU ready status
-		******************************/
-		u4Byte	value32 = 0;
-		PlatformIOWrite1Byte(Adapter, REG_SYS_FUNC_EN+1, 0x54);
-		PlatformIOWrite1Byte(Adapter, REG_MCUFWDL, 0);
-		#else
-		/*****************************
-		f.	MCUFWDL 0x80[7:0]=0				// reset MCU ready status
-		g.	SYS_FUNC_EN 0x02[10]= 0			// reset MCU register, (8051 reset)
-		h.	SYS_FUNC_EN 0x02[15-12]= 5		// reset MAC register, DCORE
-		i.     SYS_FUNC_EN 0x02[10]= 1			// enable MCU register, (8051 enable)
-		******************************/
-			u16 valu16 = 0;
-			rtw_write8(Adapter, REG_MCUFWDL, 0);
+	u8 retry_cnts = 0;
+	// 2010/08/12 MH For USB SS, we can not stop 8051 when we are trying to
+	// enter IPS/HW&SW radio off. For S3/S4/S5/Disable, we can stop 8051 because
+	// we will init FW when power on again.
+	if(rtw_read8(Adapter, REG_MCUFWDL) & BIT1) { //IF fw in RAM code, do reset
+
+		if(Adapter->bFWReady) {
+			rtw_write8(Adapter, REG_FSIMR, 0x00);
+			// 2010/08/25 MH Accordign to RD alfred's suggestion, we need to disable other
+			// HRCV INT to influence 8051 reset.
+			rtw_write8(Adapter, REG_FWIMR, 0x20);
+			// 2011/02/15 MH According to Alex's suggestion, close mask to prevent incorrect FW write operation.
+			rtw_write8(Adapter, REG_FTIMR, 0x00);
 
-			valu16 = rtw_read16(Adapter, REG_SYS_FUNC_EN);
-			rtw_write16(Adapter, REG_SYS_FUNC_EN, (valu16 & (~FEN_CPUEN)));//reset MCU ,8051
+			rtw_write8(Adapter, REG_MCUFWDL, 0);
+			rtw_write8(Adapter, REG_HMETFR+3, 0x20);//8051 reset by self
 
-			valu16 = rtw_read16(Adapter, REG_SYS_FUNC_EN)&0x0FFF;
-			rtw_write16(Adapter, REG_SYS_FUNC_EN, (valu16 |(FEN_HWPDN|FEN_ELDR)));//reset MAC
+			while( (retry_cnts++ <100) && (FEN_CPUEN &rtw_read16(Adapter, REG_SYS_FUNC_EN)))
+				rtw_udelay_os(50);//us
 
-			#ifdef DBG_SHOW_MCUFWDL_BEFORE_51_ENABLE
-			{
-				u8 val;
-				if( (val=rtw_read8(Adapter, REG_MCUFWDL)))
-					DBG_871X("DBG_SHOW_MCUFWDL_BEFORE_51_ENABLE %s:%d REG_MCUFWDL:0x%02x\n", __FUNCTION__, __LINE__, val);
+			if (retry_cnts>= 100) {
+				rtw_write8(Adapter, REG_FWIMR, 0x00);
+				// 2010/08/31 MH According to Filen's info, if 8051 reset fail, reset MAC directly.
+				rtw_write8(Adapter, REG_SYS_FUNC_EN+1, 0x50);	//Reset MAC and Enable 8051
+				rtw_mdelay_os(10);
+			} else {
+				DBG_8192C("=====> 8051 reset success (%d) .\n",retry_cnts);
 			}
-			#endif
-
-
-			valu16 = rtw_read16(Adapter, REG_SYS_FUNC_EN);
-			rtw_write16(Adapter, REG_SYS_FUNC_EN, (valu16 | FEN_CPUEN));//enable MCU ,8051
-
-
-		#endif
+		}
+	} else {
+		DBG_8192C("=====> 8051 in ROM.\n");
 	}
-	else{
-		u8 retry_cnts = 0;
-		// 2010/08/12 MH For USB SS, we can not stop 8051 when we are trying to
-		// enter IPS/HW&SW radio off. For S3/S4/S5/Disable, we can stop 8051 because
-		// we will init FW when power on again.
-		//if(!pDevice->RegUsbSS)
-		{	// If we want to SS mode, we can not reset 8051.
-			if(rtw_read8(Adapter, REG_MCUFWDL) & BIT1)
-			{ //IF fw in RAM code, do reset
-
-				if(Adapter->bFWReady)
-				{
-					rtw_write8(Adapter, REG_FSIMR, 0x00);
-					// 2010/08/25 MH Accordign to RD alfred's suggestion, we need to disable other
-					// HRCV INT to influence 8051 reset.
-					rtw_write8(Adapter, REG_FWIMR, 0x20);
-					// 2011/02/15 MH According to Alex's suggestion, close mask to prevent incorrect FW write operation.
-					rtw_write8(Adapter, REG_FTIMR, 0x00);
-
-					rtw_write8(Adapter, REG_MCUFWDL, 0);
-					rtw_write8(Adapter, REG_HMETFR+3, 0x20);//8051 reset by self
-
-					while( (retry_cnts++ <100) && (FEN_CPUEN &rtw_read16(Adapter, REG_SYS_FUNC_EN)))
-					{
-						rtw_udelay_os(50);//us
-					}
-					//RT_ASSERT((retry_cnts < 100), ("8051 reset failed!\n"));
-
-					if (retry_cnts>= 100)
-					{
-						rtw_write8(Adapter, REG_FWIMR, 0x00);
-						// 2010/08/31 MH According to Filen's info, if 8051 reset fail, reset MAC directly.
-						rtw_write8(Adapter, REG_SYS_FUNC_EN+1, 0x50);	//Reset MAC and Enable 8051
-						rtw_mdelay_os(10);
-					}
-					else
-					{
-						DBG_8192C("=====> 8051 reset success (%d) .\n",retry_cnts);
-					}
-				}
-			}
-			else
-			{
-				DBG_8192C("=====> 8051 in ROM.\n");
-			}
 
-			#ifdef DBG_SHOW_MCUFWDL_BEFORE_51_ENABLE
-			{
-				u8 val;
-				if( (val=rtw_read8(Adapter, REG_MCUFWDL)))
-					DBG_871X("DBG_SHOW_MCUFWDL_BEFORE_51_ENABLE %s:%d REG_MCUFWDL:0x%02x\n", __FUNCTION__, __LINE__, val);
-			}
-			#endif
-
-			rtw_write8(Adapter, REG_SYS_FUNC_EN+1, 0x54);	//Reset MAC and Enable 8051
-			rtw_write8(Adapter, REG_MCUFWDL, 0);
-
-		}
+	#ifdef DBG_SHOW_MCUFWDL_BEFORE_51_ENABLE
+	{
+		u8 val;
+		if( (val=rtw_read8(Adapter, REG_MCUFWDL)))
+			DBG_871X("DBG_SHOW_MCUFWDL_BEFORE_51_ENABLE %s:%d REG_MCUFWDL:0x%02x\n", __FUNCTION__, __LINE__, val);
 	}
+	#endif
+
+	rtw_write8(Adapter, REG_SYS_FUNC_EN+1, 0x54);	//Reset MAC and Enable 8051
+	rtw_write8(Adapter, REG_MCUFWDL, 0);
 
 	if(bWithoutHWSM){
 	/*****************************
@@ -3021,17 +2964,6 @@ _func_enter_;
 	OpMode = 0;
 	rtw_hal_set_hwreg(padapter, HW_VAR_MEDIA_STATUS, (u8 *)(&OpMode));
 
-#if 0
-	if(pHalData->interfaceIndex == 0){
-		u1bTmp = rtw_read8(padapter, REG_MAC0);
-		rtw_write8(padapter, REG_MAC0, u1bTmp&(~MAC0_ON));
-	}
-	else{
-		u1bTmp = rtw_read8(padapter, REG_MAC1);
-		rtw_write8(padapter, REG_MAC1, u1bTmp&(~MAC1_ON));
-	}
-#endif
-
 	rtw_write16(padapter, REG_GPIO_MUXCFG, rtw_read16(padapter, REG_GPIO_MUXCFG)&(~BIT12));
 
 	if(/*Adapter->bInUsbIfTest ||*/ !pHalData->bSupportRemoteWakeUp){
@@ -3039,8 +2971,7 @@ _func_enter_;
 			CardDisableHWSM(padapter, _FALSE);
 		else
 			CardDisableWithoutHWSM(padapter);
-	}
-	else{
+	} else{
 
 		// Wake on WLAN
 	}
@@ -3405,26 +3336,6 @@ _ReadBoardType(
 	boardType &= BOARD_TYPE_NORMAL_MASK;
 	boardType >>= 5;
 
-#if 0
-	switch(boardType & 0xF)
-	{
-		case 0:
-		case 1:
-		case 2:
-		case 3:
-		case 4:
-			pHalData->rf_type = RF_2T2R;
-			break;
-		case 5:
-			pHalData->rf_type = RF_1T2R;
-			break;
-		default:
-			pHalData->rf_type = RF_1T1R;
-			break;
-	}
-
-	pHalData->BluetoothCoexist = (boardType >> 4) ? _TRUE : _FALSE;
-#endif
 }
 
 
@@ -5525,51 +5436,29 @@ GetHalDefVar8192DUsb(
 	HAL_DATA_TYPE	*pHalData = GET_HAL_DATA(Adapter);
 	u8			bResult = _TRUE;
 
-	switch(eVariable)
-	{
-		case HAL_DEF_UNDERCORATEDSMOOTHEDPWDB:
-#if 0 //trunk
-			{
-				struct mlme_priv *pmlmepriv = &Adapter->mlmepriv;
-				struct sta_priv * pstapriv = &Adapter->stapriv;
-				struct sta_info * psta;
-				psta = rtw_get_stainfo(pstapriv, pmlmepriv->cur_network.network.MacAddress);
-				if(psta)
-				{
-					*((int *)pValue) = psta->rssi_stat.UndecoratedSmoothedPWDB;
-				}
-			}
-#else //v4 branch
-			//if(check_fwstate(&Adapter->mlmepriv, WIFI_STATION_STATE) == _TRUE){
-			*((int *)pValue) = pHalData->dmpriv.UndecoratedSmoothedPWDB;
-			//}
-			//else{
-
-			//}
-#endif
-			break;
-		case HAL_DEF_DRVINFO_SZ:
-			*(( u32*)pValue) = DRVINFO_SZ;
-			break;
-		case HAL_DEF_MAX_RECVBUF_SZ:
-			*(( u32*)pValue) = MAX_RECVBUF_SZ;
-			break;
-		case HAL_DEF_RX_PACKET_OFFSET:
-			*(( u32*)pValue) = RXDESC_SIZE + DRVINFO_SZ;
-			break;
-		case HAL_DEF_DBG_DM_FUNC:
-			*(( u8*)pValue) = pHalData->dmpriv.DMFlag;
-			break;
-		default:
-			//RT_TRACE(COMP_INIT, DBG_WARNING, ("GetHalDefVar8192CUsb(): Unkown variable: %d!\n", eVariable));
-			bResult = _FALSE;
-			break;
+	switch(eVariable) {
+	case HAL_DEF_UNDERCORATEDSMOOTHEDPWDB:
+		*((int *)pValue) = pHalData->dmpriv.UndecoratedSmoothedPWDB;
+		break;
+	case HAL_DEF_DRVINFO_SZ:
+		*(( u32*)pValue) = DRVINFO_SZ;
+		break;
+	case HAL_DEF_MAX_RECVBUF_SZ:
+		*(( u32*)pValue) = MAX_RECVBUF_SZ;
+		break;
+	case HAL_DEF_RX_PACKET_OFFSET:
+		*(( u32*)pValue) = RXDESC_SIZE + DRVINFO_SZ;
+		break;
+	case HAL_DEF_DBG_DM_FUNC:
+		*(( u8*)pValue) = pHalData->dmpriv.DMFlag;
+		break;
+	default:
+		bResult = _FALSE;
+		break;
 	}
-
 	return bResult;
 }
 
-
 //
 //	Description:
 //		Change default setting of specified variable.
