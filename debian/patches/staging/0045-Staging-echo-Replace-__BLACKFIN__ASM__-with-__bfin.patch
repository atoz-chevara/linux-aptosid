From f55ccbf6bc5e5e857b15f51d481aa7b1cd993ae0 Mon Sep 17 00:00:00 2001
From: Tzafrir Cohen <tzafrir@cohens.org.il>
Date: Sun, 12 Oct 2008 08:13:21 +0200
Subject: [PATCH] Staging: echo: Replace __BLACKFIN__ASM__ with __bfin__

Signed-off-by: Tzafrir Cohen <tzafrir@cohens.org.il>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
---
 drivers/staging/echo/echo.c |    2 +-
 drivers/staging/echo/fir.h  |    8 ++++----
 2 files changed, 5 insertions(+), 5 deletions(-)

--- a/drivers/staging/echo/echo.c
+++ b/drivers/staging/echo/echo.c
@@ -127,7 +127,7 @@
 /* adapting coeffs using the traditional stochastic descent (N)LMS algorithm */
 
 
-#ifdef __BLACKFIN_ASM__
+#ifdef __bfin__
 static void __inline__ lms_adapt_bg(struct oslec_state *ec, int clean, int shift)
 {
     int i, j;
--- a/drivers/staging/echo/fir.h
+++ b/drivers/staging/echo/fir.h
@@ -116,7 +116,7 @@ static __inline__ const int16_t *fir16_c
 	fir->taps = taps;
 	fir->curr_pos = taps - 1;
 	fir->coeffs = coeffs;
-#if defined(USE_MMX)  ||  defined(USE_SSE2) || defined(__BLACKFIN_ASM__)
+#if defined(USE_MMX)  ||  defined(USE_SSE2) || defined(__bfin__)
 	if ((fir->history = malloc(2*taps*sizeof(int16_t))))
 		memset(fir->history, 0, 2*taps*sizeof(int16_t));
 #else
@@ -129,7 +129,7 @@ static __inline__ const int16_t *fir16_c
 
 static __inline__ void fir16_flush(fir16_state_t *fir)
 {
-#if defined(USE_MMX)  ||  defined(USE_SSE2) || defined(__BLACKFIN_ASM__)
+#if defined(USE_MMX)  ||  defined(USE_SSE2) || defined(__bfin__)
     memset(fir->history, 0, 2*fir->taps*sizeof(int16_t));
 #else
     memset(fir->history, 0, fir->taps*sizeof(int16_t));
@@ -143,7 +143,7 @@ static __inline__ void fir16_free(fir16_
 }
 /*- End of function --------------------------------------------------------*/
 
-#ifdef __BLACKFIN_ASM__
+#ifdef __bfin__
 static inline int32_t dot_asm(short *x, short *y, int len)
 {
    int dot;
@@ -242,7 +242,7 @@ static __inline__ int16_t fir16(fir16_st
     psrldq_i2r(4, xmm0);
     paddd_r2r(xmm0, xmm4);
     movd_r2m(xmm4, y);
-#elif defined(__BLACKFIN_ASM__)
+#elif defined(__bfin__)
     fir->history[fir->curr_pos] = sample;
     fir->history[fir->curr_pos + fir->taps] = sample;
     y = dot_asm((int16_t*)fir->coeffs, &fir->history[fir->curr_pos], fir->taps);
